!function t(e,o,n){function r(i,s){if(!o[i]){if(!e[i]){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(l)return l(i,!0);throw new Error("Cannot find module '"+i+"'")}var u=o[i]={exports:{}};e[i][0].call(u.exports,function(t){var o=e[i][1][t];return r(o?o:t)},u,u.exports,t,e,o,n)}return o[i].exports}for(var l="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e){var o;if(o=function(){function t(){this._listeners=[]}return t.prototype._name="Selections",t.prototype._getModel=function(t,e){return null==this._model&&(this._model=new e.Composition(this,[]).execute()),this._model},t.prototype._setModel=function(t){this._model=t},t.prototype._apply=function(t){var e,o,n,r,l,i,s,c,u,f,p,a,h,m,y,d,_,w,v,g;for(y=[],s=this._model.HB.getOperation(t.from),m=this._model.HB.getOperation(t.to),p={from:s,to:m,type:t.type,attrs:t.attrs},v=this._listeners,_=0,w=v.length;w>_;_++)c=v[_],c.call(this,p);for(o=function(t,e,o){var n,r,l;r={};for(n in o)l=o[n],r[n]=l;return{from:t,to:e,attrs:r}},i=function(e){var o,n,r,l,i,s,c,u,f,p;if("unselect"===t.type){for(n={},f=t.attrs,c=0,u=f.length;u>c;c++)o=f[c],null!=e.attrs[o]&&(n[o]=e.attrs[o]),delete e.attrs[o];return y.push({from:t.from,to:t.to,attrs:n,type:"select"})}n={},r=[],i=!1,l=!1,p=t.attrs;for(o in p)s=p[o],null!=e.attrs[o]?(n[o]=e.attrs[o],l=!0):(r.push(o),i=!0),e.attrs[o]=s;return l&&y.push({from:t.from,to:t.to,attrs:n,type:"select"}),i?y.push({from:t.from,to:t.to,attrs:r,type:"unselect"}):void 0},(null==s||null==m)&&console.log("wasn't able to apply the selection.."),n=function(){var t,e,n,r;if(null==s.selection||s.selection.from!==s){for(e=s.prev_cl;null==e.selection&&"Delimiter"!==e.type;)e=e.prev_cl;if(null!=e.selection&&e.selection.to!==e){for(n=e.selection,e=s;e!==n.to&&e!==m;)e=e.next_cl;return e===n.to?(t=o(s,n.to,n.attrs),n.to=s.prev_cl,n.to.selection=n,t.from.selection=t,t.to.selection=t):(t=o(s,m,n.attrs),r=o(m.next_cl,n.to,n.attrs),n.to=s.prev_cl,n.to.selection=n,r.from.selection=r,r.to.selection=r,t.from.selection=t,t.to.selection=t)}}},n(),r=function(){var t,e,n;if(null==m.selection||m.selection.to!==m){for(e=m;null==e.selection&&e!==s;)e=e.prev_cl;if(null!=e.selection&&e.selection.to!==e)return n=e.selection,t=o(m.next_cl,n.to,n.attrs),n.to=m,n.to.selection=n,t.from.selection=t,t.to.selection=t}},r(),f=s;f!==m.next_cl;)if(null!=f.selection)i(f.selection,t),f=f.selection.to.next_cl;else{for(h=f;null==f.next_cl.selection&&f!==m;)f=f.next_cl;if(l=f,"unselect"!==t.type){e=[],g=t.attrs;for(u in g)d=g[u],e.push(u);y.push({from:h.getUid(),to:l.getUid(),attrs:e,type:"unselect"}),a=o(h,l,t.attrs),h.selection=a,l.selection=a}f=f.next_cl}return t},t.prototype._unapply=function(t){var e,o,n;for(o=0,n=t.length;n>o;o++)e=t[o],this._apply(e)},t.prototype.select=function(t,e,o){var n,r,l;l=0;for(n in o){l++;break}if(!(0>=l))return r={from:t.getUid(),to:e.getUid(),attrs:o,type:"select"},this._model.applyDelta(r)},t.prototype.unselect=function(t,e,o){var n;if("string"==typeof o&&(o=[o]),o.constructor!==Array)throw new Error("Y.Selections.prototype.unselect expects an Array or String as the third parameter (attributes)!");return o.length<=0?void 0:(n={from:t.getUid(),to:e.getUid(),attrs:o,type:"unselect"},this._model.applyDelta(n))},t.prototype.getSelections=function(t){var e,o,n,r,l,i,s,c,u;if(r=t.ref(0),null==r)return[];for(s=null,l=0,i=[];null!=r.next_cl;){if(null!=r.selection){if(r.selection.from===r){if(null!=s)throw new Error("Found two consecutive from elements. The selections are no longer safe to use! (contact the owner of the repository)");s=l}if(r.selection.to===r){if(null==s)throw new Error("Found two consecutive to elements. The selections are no longer safe to use! (contact the owner of the repository)");n=0,e={},u=r.selection.attrs;for(o in u)c=u[o],e[o]=c,n++;n>0&&i.push({from:s,to:l,attrs:e}),s=null}else if(r.selection.from!==r)throw new Error("This reference should not point to this selection, because the selection does not point to the reference. The selections are no longer safe to use! (contact the owner of the repository)")}l++,r=r.next_cl}return i},t.prototype.observe=function(t){return this._listeners.push(t)},t.prototype.unobserve=function(t){return this._listeners=this._listeners.filter(function(e){return t!==e})},t}(),"undefined"!=typeof window&&null!==window){if(null==window.Y)throw new Error("You must first import Y!");window.Y.Selections=o}"undefined"!=typeof e&&null!==e&&(e.exports=o)},{}]},{},[1]);