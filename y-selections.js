!function e(t,o,n){function r(l,s){if(!o[l]){if(!t[l]){var c="function"==typeof require&&require;if(!s&&c)return c(l,!0);if(i)return i(l,!0);throw new Error("Cannot find module '"+l+"'")}var u=o[l]={exports:{}};t[l][0].call(u.exports,function(e){var o=t[l][1][e];return r(o?o:e)},u,u.exports,e,t,o,n)}return o[l].exports}for(var i="function"==typeof require&&require,l=0;l<n.length;l++)r(n[l]);return r}({1:[function(e,t){var o;if(o=function(){function e(){this._listeners=[],this._composition_value=[],this._lists=[]}return e.prototype._name="Selections",e.prototype._getModel=function(e,t){return null==this._model&&(this._model=new t.Composition(this,[]).execute()),this._model},e.prototype._setModel=function(e){this._model=e},e.prototype._getCompositionValue=function(){var e,t,o,n;return t={},e=function(){var e,r,i,l;for(i=this._composition_value,l=[],o=e=0,r=i.length;r>e;o=++e)n=i[o],t[""+o+"/from"]=n.from,t[""+o+"/to"]=n.to,l.push({attrs:n.attrs});return l}.call(this),{composition_value:e,composition_value_operations:t}},e.prototype._setCompositionValue=function(e){var t,o,n,r;for(r=[],o=0,n=e.length;n>o;o++)t=e[o],t.type="select",r.push(this._apply(t));return r},e.prototype._apply=function(e){var t,o,n,r,i,l,s,c,u,f,p,a,h,m,_,v,y,d,w,g,x,b,C,E;for(w=[],f=e.from,d=e.to,function(e){return function(){var t,o,n,r,i,l;for(o=f.getParent(),n=!1,l=e._lists,r=0,i=l.length;i>r;r++)if(t=l[r],o===e._lists[t]){n=!0;break}return n?void 0:o.observe(function(t){var o,n,r,i,l,s,c,u;for(u=[],s=0,c=t.length;c>s;s++)if(o=t[s],"delete"===o.type&&null!=o.reference.selection)if(i=o.reference,l=i.selection,delete i.selection,l.from===i&&l.to===i)u.push(e._removeFromCompositionValue(l));else if(l.from===i)r=i.getNext(),l.from=r,u.push(r.selection=l);else{if(l.to!==i)throw new Error("Found weird inconsistency! Y.Selections is no longer safe to use!");n=i.getPrev(),l.to=n,u.push(n.selection=l)}else u.push(void 0);return u})}}(this)(),m={from:f,to:d,type:e.type,attrs:e.attrs},C=this._listeners,x=0,b=C.length;b>x;x++)p=C[x],p.call(this,m);for(i=function(e){return function(t,o,n){var r,i,l,s;i={};for(r in n)s=n[r],i[r]=s;return l={from:t,to:o,attrs:i},e._composition_value.push(l),l}}(this),u=function(t){var o,n,r,i,l,s,c,u,f,p;if("unselect"===e.type){for(n={},f=e.attrs,c=0,u=f.length;u>c;c++)o=f[c],null!=t.attrs[o]&&(n[o]=t.attrs[o]),delete t.attrs[o];return w.push({from:e.from,to:e.to,attrs:n,type:"select"})}n={},r=[],l=!1,i=!1,p=e.attrs;for(o in p)s=p[o],null!=t.attrs[o]?(n[o]=t.attrs[o],i=!0):(r.push(o),l=!0),t.attrs[o]=s;return i&&w.push({from:e.from,to:e.to,attrs:n,type:"select"}),l?w.push({from:e.from,to:e.to,attrs:r,type:"unselect"}):void 0},l=function(){var e,t,o,n;if(null==f.selection||f.selection.from!==f){for(t=f.prev_cl;null==t.selection&&"Delimiter"!==t.type;)t=t.prev_cl;if(null!=t.selection&&t.selection.to!==t){for(o=t.selection,t=f;t!==o.to&&t!==d;)t=t.next_cl;return t===o.to?(e=i(f,o.to,o.attrs),o.to=f.prev_cl,o.to.selection=o,e.from.selection=e,e.to.selection=e):(e=i(f,d,o.attrs),n=i(d.next_cl,o.to,o.attrs),o.to=f.prev_cl,o.to.selection=o,n.from.selection=n,n.to.selection=n,e.from.selection=e,e.to.selection=e)}}},l(),s=function(){var e,t,o;if(null==d.selection||d.selection.to!==d){for(t=d;null==t.selection&&t!==f;)t=t.prev_cl;if(null!=t.selection&&t.selection.to!==t)return o=t.selection,e=i(d.next_cl,o.to,o.attrs),o.to=d,o.to.selection=o,e.from.selection=e,e.to.selection=e}},s(),r=function(e,t,o){var n,i;null==o&&(o=!0);for(n in e)if(i=e[n],null==t[n]||t[n]!==i)return!1;return o?r(t,e,!1):!0},n=function(e){return function(t){var o,n;for(o=t.from.prev_cl;null!=o&&o.isDeleted()&&null==o.selection;)o=o.prev_cl;if(null==o||null==o.selection);else if(r(o.selection.attrs,t.attrs))return n=o.selection.from,e._removeFromCompositionValue(o.selection),t.from!==t.to&&delete t.from.selection,t.from=n,n.selection=t}}(this),h=f;h!==d.next_cl;)if(null!=h.selection){u(h.selection,e),_=h.selection,n(_),h=_.to.next_cl,v=!0;for(t in _.attrs){v=!1;break}v&&this._removeFromCompositionValue(_)}else{for(y=h;null==h.next_cl.selection&&h!==d;)h=h.next_cl;if(c=h,"unselect"!==e.type){o=[],E=e.attrs;for(a in E)g=E[a],o.push(a);w.push({from:y,to:c,attrs:o,type:"unselect"}),_=i(y,c,e.attrs),y.selection=_,c.selection=_,n(h.selection)}h=h.next_cl}for(;h.isDeleted()&&null==h.selection;)h=h.next_cl;return null!=h.selection&&n(h.selection),null!=f.selection&&n(f.selection),e},e.prototype._removeFromCompositionValue=function(e){return this._composition_value=this._composition_value.filter(function(t){return t!==e}),delete e.from.selection,delete e.to.selection},e.prototype._unapply=function(e){var t,o,n;for(o=0,n=e.length;n>o;o++)t=e[o],this._apply(t)},e.prototype.select=function(e,t,o){var n,r,i,l;l=0;for(n in o){l++;break}if(!(0>=l))return i={from:e,to:t},r={attrs:o,type:"select"},this._model.applyDelta(r,i)},e.prototype.unselect=function(e,t,o){var n,r;if("string"==typeof o&&(o=[o]),o.constructor!==Array)throw new Error("Y.Selections.prototype.unselect expects an Array or String as the third parameter (attributes)!");return o.length<=0?void 0:(r={from:e,to:t},n={attrs:o,type:"unselect"},this._model.applyDelta(n,r))},e.prototype.getSelections=function(e){var t,o,n,r,i,l,s,c,u;if(r=e.ref(0),null==r)return[];for(s=null,i=0,l=[];null!=r.next_cl;)if(r.isDeleted())r=r.next_cl;else{if(null!=r.selection){if(r.selection.from===r){if(null!=s)throw new Error("Found two consecutive from elements. The selections are no longer safe to use! (contact the owner of the repository)");s=i}if(r.selection.to===r){if(null==s)throw new Error("Found two consecutive to elements. The selections are no longer safe to use! (contact the owner of the repository)");n=0,t={},u=r.selection.attrs;for(o in u)c=u[o],t[o]=c,n++;n>0&&l.push({from:s,to:i,attrs:t}),s=null}else if(r.selection.from!==r)throw new Error("This reference should not point to this selection, because the selection does not point to the reference. The selections are no longer safe to use! (contact the owner of the repository)")}i++,r=r.next_cl}return l},e.prototype.observe=function(e){return this._listeners.push(e)},e.prototype.unobserve=function(e){return this._listeners=this._listeners.filter(function(t){return e!==t})},e}(),"undefined"!=typeof window&&null!==window){if(null==window.Y)throw new Error("You must first import Y!");window.Y.Selections=o}"undefined"!=typeof t&&null!==t&&(t.exports=o)},{}]},{},[1]);