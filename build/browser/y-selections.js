(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var YSelections;

YSelections = (function() {
  function YSelections() {}

  YSelections.prototype._name = "Selections";

  YSelections.prototype._getModel = function(Y, Operation) {
    if (this._model == null) {
      this._model = new Operation.Composition(this, []).execute();
    }
    return this._model;
  };

  YSelections.prototype._setModel = function(_model) {
    this._model = _model;
  };

  YSelections.prototype._apply = function(delta) {
    var createSelection, cut_off_from, cut_off_to, end, extendSelection, from, o, selection, start, to;
    from = this._model.HB.getOperation(delta.from);
    to = this._model.HB.getOperation(delta.to);
    createSelection = function(from, to, attrs) {
      var n, new_attrs, v;
      new_attrs = {};
      for (n in attrs) {
        v = attrs[n];
        new_attrs[n] = v;
      }
      return {
        from: from,
        to: to,
        attrs: new_attrs
      };
    };
    extendSelection = function(selection) {
      var n, v, _i, _len, _ref, _ref1, _results, _results1;
      if (delta.type === "unselect") {
        _ref = delta.attrs;
        _results = [];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          n = _ref[_i];
          _results.push(delete selection.attrs[n]);
        }
        return _results;
      } else {
        _ref1 = delta.attrs;
        _results1 = [];
        for (n in _ref1) {
          v = _ref1[n];
          _results1.push(selection.attrs[n] = v);
        }
        return _results1;
      }
    };
    if (!((from != null) && (to != null))) {
      console.log("wasn't able to apply the selection..");
    }
    cut_off_from = function() {
      var new_selection, o, old_selection, opt_selection;
      if ((from.selection != null) && from.selection.from === from) {
        return;
      }
      o = from.prev_cl;
      while ((o.selection == null) && (o.type !== "Delimiter")) {
        o = o.prev_cl;
      }
      if ((o.selection == null) || o.selection.to === o) {
        return;
      }
      old_selection = o.selection;
      o = from;
      while ((o !== old_selection.to) && (o !== to)) {
        o = o.next_cl;
      }
      if (o === old_selection.to) {
        new_selection = createSelection(from, old_selection.to, old_selection.attrs);
        old_selection.to = from.prev_cl;
        old_selection.to.selection = old_selection;
        extendSelection(new_selection, delta);
        new_selection.from.selection = new_selection;
        return new_selection.to.selection = new_selection;
      } else {
        new_selection = createSelection(from, to, old_selection.attrs);
        opt_selection = createSelection(to.next_cl, old_selection.to, old_selection.attrs);
        old_selection.to = from.prev_cl;
        old_selection.to.selection = old_selection;
        opt_selection.from.selection = opt_selection;
        opt_selection.to.selection = opt_selection;
        extendSelection(new_selection, delta);
        new_selection.from.selection = new_selection;
        return new_selection.to.selection = new_selection;
      }
    };
    cut_off_from();
    cut_off_to = function() {
      var new_selection, o, old_selection;
      if ((to.selection != null) && to.selection.to === to) {
        return;
      }
      o = to;
      while ((o.selection == null) && (o !== from)) {
        o = o.prev_cl;
      }
      if ((o.selection == null) || o.selection["to"] === o) {
        return;
      }
      old_selection = o.selection;
      new_selection = createSelection(to.next_cl, old_selection.to, old_selection.attrs);
      extendSelection(old_selection, delta);
      old_selection.to = to;
      old_selection.to.selection = old_selection;
      new_selection.from.selection = new_selection;
      return new_selection.to.selection = new_selection;
    };
    cut_off_to();
    o = from;
    while (o !== to.next_cl) {
      if (o.selection != null) {
        console.log("1");
        extendSelection(o.selection, delta);
        o = o.selection.to.next_cl;
      } else {
        console.log("2");
        start = o;
        while ((o.next_cl.selection == null) && (o !== to)) {
          o = o.next_cl;
        }
        end = o;
        if (delta.type !== "unselect") {
          selection = createSelection(start, end, delta.attrs);
          start.selection = selection;
          end.selection = selection;
        }
        o = o.next_cl;
      }
    }
    return delta;
  };

  YSelections.prototype._unapply = function(delta) {
    var from, to;
    from = this._model.HB.getOperation(delta.from);
    to = this._model.HB.getOperation(delta.to);
    if (!((from != null) && (to != null))) {
      console.log("wasn't able to unapply the selection..");
    }
    if (delta.type === "select") {
      delete from.selection;
      return delete to.selection;
    } else if (delta.type === "unselect") {

    } else {
      throw new Error("unsupported delta!");
    }
  };

  YSelections.prototype.select = function(from, to, attrs) {
    var delta;
    delta = {
      from: from.getUid(),
      to: to.getUid(),
      attrs: attrs,
      type: "select"
    };
    return this._model.applyDelta(delta);
  };

  YSelections.prototype.unselect = function(from, to, attrs) {
    var delta;
    if (typeof attrs === "string") {
      attrs = [attrs];
    }
    if (attrs.constructor !== Array) {
      throw new Error("Y.Selections.prototype.unselect expects an Array or String as the third parameter (attributes)!");
    }
    delta = {
      from: from.getUid(),
      to: to.getUid(),
      attrs: attrs,
      type: "unselect"
    };
    return this._model.applyDelta(delta);
  };

  YSelections.prototype.getSelections = function(list) {
    var attrs, n, number_of_attrs, o, pos, result, sel_start, v, _ref;
    o = list.ref(0);
    sel_start = null;
    pos = 0;
    result = [];
    while (o.next_cl != null) {
      if (o.selection != null) {
        if (o.selection.from === o) {
          if (sel_start != null) {
            throw new Error("Found two consecutive from elements. The selections are no longer safe to use! (contact the owner of the repository)");
          } else {
            sel_start = pos;
          }
        }
        if (o.selection.to === o) {
          if (sel_start != null) {
            number_of_attrs = 0;
            attrs = {};
            _ref = o.selection.attrs;
            for (n in _ref) {
              v = _ref[n];
              attrs[n] = v;
              number_of_attrs++;
            }
            if (number_of_attrs > 0) {
              result.push({
                from: sel_start,
                to: pos,
                attrs: attrs
              });
            }
            sel_start = null;
          } else {
            throw new Error("Found two consecutive to elements. The selections are no longer safe to use! (contact the owner of the repository)");
          }
        } else if (o.selection.from !== o) {
          throw new Error("This reference should not point to this selection, because the selection does not point to the reference. The selections are no longer safe to use! (contact the owner of the repository)");
        }
      }
      pos++;
      o = o.next_cl;
    }
    return result;
  };

  YSelections.prototype.observe = function(f) {
    return this._model.observe(f);
  };

  return YSelections;

})();

if (typeof window !== "undefined" && window !== null) {
  if (window.Y != null) {
    window.Y.Selections = YSelections;
  } else {
    throw new Error("You must first import Y!");
  }
}

if (typeof module !== "undefined" && module !== null) {
  module.exports = YSelections;
}


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2NvZGlvL3dvcmtzcGFjZS95LXNlbGVjdGlvbnMvbm9kZV9tb2R1bGVzL2d1bHAtYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL2hvbWUvY29kaW8vd29ya3NwYWNlL3ktc2VsZWN0aW9ucy9saWIveS1zZWxlY3Rpb25zLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0dBLElBQUEsV0FBQTs7QUFBQTtBQUNlLEVBQUEscUJBQUEsR0FBQSxDQUFiOztBQUFBLHdCQUVBLEtBQUEsR0FBTyxZQUZQLENBQUE7O0FBQUEsd0JBSUEsU0FBQSxHQUFXLFNBQUMsQ0FBRCxFQUFJLFNBQUosR0FBQTtBQUNULElBQUEsSUFBTyxtQkFBUDtBQUNFLE1BQUEsSUFBQyxDQUFBLE1BQUQsR0FBYyxJQUFBLFNBQVMsQ0FBQyxXQUFWLENBQXNCLElBQXRCLEVBQXlCLEVBQXpCLENBQTRCLENBQUMsT0FBN0IsQ0FBQSxDQUFkLENBREY7S0FBQTtXQUVBLElBQUMsQ0FBQSxPQUhRO0VBQUEsQ0FKWCxDQUFBOztBQUFBLHdCQVNBLFNBQUEsR0FBVyxTQUFFLE1BQUYsR0FBQTtBQUFVLElBQVQsSUFBQyxDQUFBLFNBQUEsTUFBUSxDQUFWO0VBQUEsQ0FUWCxDQUFBOztBQUFBLHdCQVdBLE1BQUEsR0FBUSxTQUFDLEtBQUQsR0FBQTtBQUVOLFFBQUEsOEZBQUE7QUFBQSxJQUFBLElBQUEsR0FBTyxJQUFDLENBQUEsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFYLENBQXdCLEtBQUssQ0FBQyxJQUE5QixDQUFQLENBQUE7QUFBQSxJQUNBLEVBQUEsR0FBSyxJQUFDLENBQUEsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFYLENBQXdCLEtBQUssQ0FBQyxFQUE5QixDQURMLENBQUE7QUFBQSxJQUVBLGVBQUEsR0FBa0IsU0FBQyxJQUFELEVBQU8sRUFBUCxFQUFXLEtBQVgs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LENBQUE7O0FBQUEsd0JBZ1FBLE9BQUEsR0FBUyxTQUFDLENBQUQsR0FBQTtXQUNQLElBQUMsQ0FBQSxNQUFNLENBQUMsT0FBUixDQUFnQixDQUFoQixFQURPO0VBQUEsQ0FoUVQsQ0FBQTs7cUJBQUE7O0lBREYsQ0FBQTs7QUFxUUEsSUFBRyxnREFBSDtBQUNFLEVBQUEsSUFBRyxnQkFBSDtBQUNFLElBQUEsTUFBTSxDQUFDLENBQUMsQ0FBQyxVQUFULEdBQXNCLFdBQXRCLENBREY7R0FBQSxNQUFBO0FBR0UsVUFBVSxJQUFBLEtBQUEsQ0FBTSwwQkFBTixDQUFWLENBSEY7R0FERjtDQXJRQTs7QUEyUUEsSUFBRyxnREFBSDtBQUNFLEVBQUEsTUFBTSxDQUFDLE9BQVAsR0FBaUIsV0FBakIsQ0FERjtDQTNRQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpfXZhciBmPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGYsZi5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcblxuXG5jbGFzcyBZU2VsZWN0aW9uc1xuICBjb25zdHJ1Y3RvcjogKCktPlxuXG4gIF9uYW1lOiBcIlNlbGVjdGlvbnNcIlxuXG4gIF9nZXRNb2RlbDogKFksIE9wZXJhdGlvbikgLT5cbiAgICBpZiBub3QgQF9tb2RlbD9cbiAgICAgIEBfbW9kZWwgPSBuZXcgT3BlcmF0aW9uLkNvbXBvc2l0aW9uKEAsIFtdKS5leGVjdXRlKClcbiAgICBAX21vZGVsXG5cbiAgX3NldE1vZGVsOiAoQF9tb2RlbCktPlxuXG4gIF9hcHBseTogKGRlbHRhKS0+XG4gICAgIyBUT0RPOiBjdXJyZW50bHksIGFwcGxpZXMgdGhlIGRlbHRhIF9hcyBpc18uXG4gICAgZnJvbSA9IEBfbW9kZWwuSEIuZ2V0T3BlcmF0aW9uIGRlbHRhLmZyb21cbiAgICB0byA9IEBfbW9kZWwuSEIuZ2V0T3BlcmF0aW9uIGRlbHRhLnRvXG4gICAgY3JlYXRlU2VsZWN0aW9uID0gKGZyb20sIHRvLCBhdHRycyktPlxuICAgICAgbmV3X2F0dHJzID0ge31cbiAgICAgIGZvciBuLHYgb2YgYXR0cnNcbiAgICAgICAgbmV3X2F0dHJzW25dID0gdlxuICAgICAge1xuICAgICAgICBmcm9tOiBmcm9tXG4gICAgICAgIHRvOiB0b1xuICAgICAgICBhdHRyczogbmV3X2F0dHJzXG4gICAgICB9XG5cbiAgICBleHRlbmRTZWxlY3Rpb24gPSAoc2VsZWN0aW9uKS0+XG4gICAgICBpZiBkZWx0YS50eXBlIGlzIFwidW5zZWxlY3RcIlxuICAgICAgICBmb3IgbiBpbiBkZWx0YS5hdHRyc1xuICAgICAgICAgIGRlbGV0ZSBzZWxlY3Rpb24uYXR0cnNbbl1cbiAgICAgIGVsc2VcbiAgICAgICAgZm9yIG4sdiBvZiBkZWx0YS5hdHRyc1xuICAgICAgICAgIHNlbGVjdGlvbi5hdHRyc1tuXSA9IHZcblxuICAgIGlmIG5vdCAoZnJvbT8gYW5kIHRvPylcbiAgICAgIGNvbnNvbGUubG9nIFwid2Fzbid0IGFibGUgdG8gYXBwbHkgdGhlIHNlbGVjdGlvbi4uXCJcbiAgICAjIEFsZ29yaXRobSBvdmVydmlldzpcbiAgICAjIDEuIGN1dCBvZmYgdGhlIHNlbGVjdGlvbiB0aGF0IGludGVyc2VjdHMgd2l0aCBmcm9tXG4gICAgIyAyLiBjdXQgb2ZmIHRoZSBzZWxlY3Rpb24gdGhhdCBpbnRlcnNlY3RzIHdpdGggdG9cbiAgICAjIDMuIGV4dGVuZCAvIGFkZCBzZWxlY3Rpb25zIGluIGJldHdlZW5cblxuICAgICNcbiAgICAjIyMjIDEuIGN1dCBvZmYgdGhlIHNlbGVjdGlvbiB0aGF0IGludGVyc2VjdHMgd2l0aCBmcm9tXG4gICAgI1xuICAgIGN1dF9vZmZfZnJvbSA9ICgpLT5cbiAgICAgICMgY2hlY2sgaWYgYSBzZWxlY3Rpb24gKHRvIHRoZSBsZWZ0IG9mICRmcm9tKSBpbnRlcnNlY3RzIHdpdGggJGZyb21cbiAgICAgIGlmIGZyb20uc2VsZWN0aW9uPyBhbmQgZnJvbS5zZWxlY3Rpb24uZnJvbSBpcyBmcm9tXG4gICAgICAgICMgZG9lcyBub3QgaW50ZXJzZWN0LCBiZWNhdXNlIHRoZSBzdGFydCBpcyBhbHJlYWR5IHNlbGVjdGVkXG4gICAgICAgIHJldHVyblxuICAgICAgIyBmaW5kIGZpcnN0IHNlbGVjdGlvbiB0byB0aGUgbGVmdFxuICAgICAgbyA9IGZyb20ucHJldl9jbFxuICAgICAgd2hpbGUgKG5vdCBvLnNlbGVjdGlvbj8pIGFuZCAoby50eXBlIGlzbnQgXCJEZWxpbWl0ZXJcIilcbiAgICAgICAgbyA9IG8ucHJldl9jbFxuICAgICAgaWYgKG5vdCBvLnNlbGVjdGlvbj8pIG9yIG8uc2VsZWN0aW9uLnRvIGlzIG9cbiAgICAgICAgIyBubyBpbnRlcnNlY3Rpb25cbiAgICAgICAgcmV0dXJuXG4gICAgICAjIFdlIGZvdW5kIGEgc2VsZWN0aW9uIHRoYXQgaW50ZXJzZWN0cyB3aXRoICRmcm9tLlxuICAgICAgIyBOb3cgd2UgaGF2ZSB0byBjaGVjayBpZiBpdCBhbHNvIGludGVyc2VjdHMgd2l0aCAkdG8uXG4gICAgICAjIFRoZW4gd2UgY3V0IGl0IGluIHN1Y2ggYSB3YXksXG4gICAgICAjIHRoYXQgdGhlIHNlbGVjdGlvbiBkb2VzIG5vdCBpbnRlcnNlY3Qgd2l0aCAkZnJvbSBhbmQgJHRvIGFueW1vcmUuXG5cbiAgICAgICMgdGhpcyBpcyBhIHJlZmVyZW5jZSBmb3IgdGhlIHNlbGVjdGlvbnMgdGhhdCBhcmUgY3JlYXRlZC9tb2RpZmllZDpcbiAgICAgICMgb2xkX3NlbGVjdGlvbiBpcyBvdXRlciAobm90IGJldHdlZW4gJGZyb20gJHRvKVxuICAgICAgIyAgIC0gd2lsbCBiZSBjaGFuZ2VkIGluIHN1Y2ggYSB3YXkgdGhhdCBpdCBpcyB0byB0aGUgbGVmdCBvZiAkZnJvbVxuICAgICAgIyBuZXdfc2VsZWN0aW9uIGlzIGlubmVyIChpbmJldHdlZW4gJGZyb20gJHRvKVxuICAgICAgIyAgIC0gY3JlYXRlZCwgcmlnaHQgYWZ0ZXIgJGZyb21cbiAgICAgICMgb3B0X3NlbGVjdGlvbiBpcyBvdXRlciAoYWZ0ZXIgJHRvKVxuICAgICAgIyAgIC0gY3JlYXRlZCAoaWYgbmVjZXNzYXJ5KSwgcmlnaHQgYWZ0ZXIgJHRvXG4gICAgICBvbGRfc2VsZWN0aW9uID0gby5zZWxlY3Rpb25cblxuICAgICAgIyBjaGVjayBpZiBmb3VuZCBzZWxlY3Rpb24gYWxzbyBpbnRlcnNlY3RzIHdpdGggJHRvXG4gICAgICAjICogc3RhcnRpbmcgZnJvbSAkZnJvbSwgZ28gdG8gdGhlIHJpZ2h0IHVudGlsIHlvdSBmb3VuZCBlaXRoZXIgJHRvIG9yIG9sZF9zZWxlY3Rpb24udG9cbiAgICAgICMgKiogaWYgJHRvOiBubyBpbnRlcnNlY3Rpb24gd2l0aCAkdG9cbiAgICAgICMgKiogaWYgJG9sZF9zZWxlY3Rpb24udG86IGludGVyc2VjdGlvbiB3aXRoICR0byEgXG4gICAgICBvID0gZnJvbVxuICAgICAgd2hpbGUgKG8gaXNudCBvbGRfc2VsZWN0aW9uLnRvKSBhbmQgKG8gaXNudCB0bylcbiAgICAgICAgbyA9IG8ubmV4dF9jbFxuXG4gICAgICBpZiBvIGlzIG9sZF9zZWxlY3Rpb24udG9cbiAgICAgICAgIyBubyBpbnRlcnNlY3Rpb24gd2l0aCB0byFcbiAgICAgICAgIyBjcmVhdGUgJG5ld19zZWxlY3Rpb25cbiAgICAgICAgbmV3X3NlbGVjdGlvbiA9IGNyZWF0ZVNlbGVjdGlvbiBmcm9tLCBvbGRfc2VsZWN0aW9uLnRvLCBvbGRfc2VsZWN0aW9uLmF0dHJzXG5cbiAgICAgICAgIyB1cGRhdGUgcmVmZXJlbmNlc1xuICAgICAgICBvbGRfc2VsZWN0aW9uLnRvID0gZnJvbS5wcmV2X2NsXG4gICAgICAgICMgdXBkYXRlIHJlZmVyZW5jZXMgKHBvaW50ZXJzIHRvIHJlc3BlY3RpdmUgc2VsZWN0aW9ucylcbiAgICAgICAgb2xkX3NlbGVjdGlvbi50by5zZWxlY3Rpb24gPSBvbGRfc2VsZWN0aW9uXG5cbiAgICAgICAgZXh0ZW5kU2VsZWN0aW9uIG5ld19zZWxlY3Rpb24sIGRlbHRhXG4gICAgICAgIG5ld19zZWxlY3Rpb24uZnJvbS5zZWxlY3Rpb24gPSBuZXdfc2VsZWN0aW9uXG4gICAgICAgIG5ld19zZWxlY3Rpb24udG8uc2VsZWN0aW9uID0gbmV3X3NlbGVjdGlvblxuICAgICAgZWxzZVxuICAgICAgICAjIHRoZXJlIGlzIGFuIGludGVyc2VjdGlvbiB3aXRoIHRvIVxuXG4gICAgICAgICMgY3JlYXRlICRuZXdfc2VsZWN0aW9uXG4gICAgICAgIG5ld19zZWxlY3Rpb24gPSBjcmVhdGVTZWxlY3Rpb24gZnJvbSwgdG8sIG9sZF9zZWxlY3Rpb24uYXR0cnNcblxuICAgICAgICAjIGNyZWF0ZSAkb3B0X3NlbGVjdGlvblxuICAgICAgICBvcHRfc2VsZWN0aW9uID0gY3JlYXRlU2VsZWN0aW9uIHRvLm5leHRfY2wsIG9sZF9zZWxlY3Rpb24udG8sIG9sZF9zZWxlY3Rpb24uYXR0cnNcblxuICAgICAgICAjIHVwZGF0ZSByZWZlcmVuY2VzXG4gICAgICAgIG9sZF9zZWxlY3Rpb24udG8gPSBmcm9tLnByZXZfY2xcbiAgICAgICAgIyB1cGRhdGUgcmVmZXJlbmNlcyAocG9pbnRlcnMgdG8gcmVzcGVjdGl2ZSBzZWxlY3Rpb25zKVxuICAgICAgICBvbGRfc2VsZWN0aW9uLnRvLnNlbGVjdGlvbiA9IG9sZF9zZWxlY3Rpb25cblxuICAgICAgICBvcHRfc2VsZWN0aW9uLmZyb20uc2VsZWN0aW9uID0gb3B0X3NlbGVjdGlvblxuICAgICAgICBvcHRfc2VsZWN0aW9uLnRvLnNlbGVjdGlvbiA9IG9wdF9zZWxlY3Rpb25cblxuICAgICAgICBleHRlbmRTZWxlY3Rpb24gbmV3X3NlbGVjdGlvbiwgZGVsdGFcbiAgICAgICAgbmV3X3NlbGVjdGlvbi5mcm9tLnNlbGVjdGlvbiA9IG5ld19zZWxlY3Rpb25cbiAgICAgICAgbmV3X3NlbGVjdGlvbi50by5zZWxlY3Rpb24gPSBuZXdfc2VsZWN0aW9uXG5cblxuICAgIGN1dF9vZmZfZnJvbSgpXG5cbiAgICAjIDIuIGN1dCBvZmYgdGhlIHNlbGVjdGlvbiB0aGF0IGludGVyc2VjdHMgd2l0aCAkdG9cbiAgICBjdXRfb2ZmX3RvID0gKCktPlxuICAgICAgIyBjaGVjayBpZiBhIHNlbGVjdGlvbiAodG8gdGhlIGxlZnQgb2YgJHRvKSBpbnRlcnNlY3RzIHdpdGggJHRvXG4gICAgICBpZiB0by5zZWxlY3Rpb24/IGFuZCB0by5zZWxlY3Rpb24udG8gaXMgdG9cbiAgICAgICAgIyBkb2VzIG5vdCBpbnRlcnNlY3QsIGJlY2F1c2UgdGhlIGVuZCBpcyBhbHJlYWR5IHNlbGVjdGVkXG4gICAgICAgIHJldHVyblxuICAgICAgIyBmaW5kIGZpcnN0IHNlbGVjdGlvbiB0byB0aGUgbGVmdFxuICAgICAgbyA9IHRvXG4gICAgICB3aGlsZSAobm90IG8uc2VsZWN0aW9uPykgYW5kIChvIGlzbnQgZnJvbSlcbiAgICAgICAgbyA9IG8ucHJldl9jbFxuICAgICAgaWYgKG5vdCBvLnNlbGVjdGlvbj8pIG9yIG8uc2VsZWN0aW9uW1widG9cIl0gaXMgb1xuICAgICAgICAjIG5vIGludGVyc2VjdGlvblxuICAgICAgICByZXR1cm5cbiAgICAgICMgV2UgZm91bmQgYSBzZWxlY3Rpb24gdGhhdCBpbnRlcnNlY3RzIHdpdGggJHRvLlxuICAgICAgIyBOb3cgd2UgaGF2ZSB0byBjdXQgaXQgaW4gc3VjaCBhIHdheSxcbiAgICAgICMgdGhhdCB0aGUgc2VsZWN0aW9uIGRvZXMgbm90IGludGVyc2VjdCB3aXRoICR0byBhbnltb3JlLlxuXG4gICAgICAjIHRoaXMgaXMgYSByZWZlcmVuY2UgZm9yIHRoZSBzZWxlY3Rpb25zIHRoYXQgYXJlIGNyZWF0ZWQvbW9kaWZpZWQ6XG4gICAgICAjIGl0IGlzIHNpbWlsYXIgdG8gdGhlIG9uZSBhYm92ZSwgZXhjZXB0IHRoYXQgd2UgZG8gbm90IG5lZWQgb3B0X3NlbGVjdGlvbiBhbnltb3JlIVxuICAgICAgIyBvbGRfc2VsZWN0aW9uIGlzIGlubmVyIChiZXR3ZWVuICRmcm9tIGFuZCAkdG8pXG4gICAgICAjICAgLSB3aWxsIGJlIGNoYW5nZWQgaW4gc3VjaCBhIHdheSB0aGF0IGl0IGlzIHRvIHRoZSBsZWZ0IG9mICR0b1xuICAgICAgIyBuZXdfc2VsZWN0aW9uIGlzIG91dGVyICggb3V0ZXIgJGZyb20gYW5kICR0bylcbiAgICAgICMgICAtIGNyZWF0ZWQsIHJpZ2h0IGFmdGVyICR0b1xuXG4gICAgICBvbGRfc2VsZWN0aW9uID0gby5zZWxlY3Rpb25cblxuICAgICAgIyBjcmVhdGUgJG5ld19zZWxlY3Rpb25cbiAgICAgIG5ld19zZWxlY3Rpb24gPSBjcmVhdGVTZWxlY3Rpb24gdG8ubmV4dF9jbCwgb2xkX3NlbGVjdGlvbi50bywgb2xkX3NlbGVjdGlvbi5hdHRyc1xuICAgICAgIyBleHRlbmQgb2xkX3NlbGVjdGlvbiB3aXRoIHRoZSBuZXcgYXR0cnNcbiAgICAgIGV4dGVuZFNlbGVjdGlvbiBvbGRfc2VsZWN0aW9uLCBkZWx0YVxuXG4gICAgICAjIHVwZGF0ZSByZWZlcmVuY2VzXG4gICAgICBvbGRfc2VsZWN0aW9uLnRvID0gdG9cbiAgICAgICMgdXBkYXRlIHJlZmVyZW5jZXMgKHBvaW50ZXJzIHRvIHJlc3BlY3RpdmUgc2VsZWN0aW9ucylcbiAgICAgIG9sZF9zZWxlY3Rpb24udG8uc2VsZWN0aW9uID0gb2xkX3NlbGVjdGlvblxuXG4gICAgICBuZXdfc2VsZWN0aW9uLmZyb20uc2VsZWN0aW9uID0gbmV3X3NlbGVjdGlvblxuICAgICAgbmV3X3NlbGVjdGlvbi50by5zZWxlY3Rpb24gPSBuZXdfc2VsZWN0aW9uXG5cbiAgICBjdXRfb2ZmX3RvKClcblxuICAgICMgMy4gZXh0ZW5kIC8gYWRkIHNlbGVjdGlvbnMgaW4gYmV0d2VlblxuICAgIG8gPSBmcm9tXG4gICAgd2hpbGUgKG8gaXNudCB0by5uZXh0X2NsKVxuICAgICAgaWYgby5zZWxlY3Rpb24/XG4gICAgICAgIGNvbnNvbGUubG9nIFwiMVwiXG4gICAgICAgICMganVzdCBleHRlbmQgdGhlIGV4aXN0aW5nIHNlbGVjdGlvblxuICAgICAgICBleHRlbmRTZWxlY3Rpb24gby5zZWxlY3Rpb24sIGRlbHRhXG4gICAgICAgIG8gPSBvLnNlbGVjdGlvbi50by5uZXh0X2NsXG4gICAgICBlbHNlXG4gICAgICAgICMgY3JlYXRlIGEgbmV3IHNlbGVjdGlvbiAodW50aWwgeW91IGZpbmQgdGhlIG5leHQgb25lKVxuICAgICAgICBjb25zb2xlLmxvZyBcIjJcIlxuICAgICAgICBzdGFydCA9IG9cbiAgICAgICAgd2hpbGUgKG5vdCBvLm5leHRfY2wuc2VsZWN0aW9uPykgYW5kIChvIGlzbnQgdG8pXG4gICAgICAgICAgbyA9IG8ubmV4dF9jbFxuICAgICAgICBlbmQgPSBvXG4gICAgICAgIGlmIGRlbHRhLnR5cGUgaXNudCBcInVuc2VsZWN0XCJcbiAgICAgICAgICBzZWxlY3Rpb24gPSBjcmVhdGVTZWxlY3Rpb24gc3RhcnQsIGVuZCwgZGVsdGEuYXR0cnNcbiAgICAgICAgICBzdGFydC5zZWxlY3Rpb24gPSBzZWxlY3Rpb25cbiAgICAgICAgICBlbmQuc2VsZWN0aW9uID0gc2VsZWN0aW9uXG4gICAgICAgIG8gPSBvLm5leHRfY2xcblxuICAgIHJldHVybiBkZWx0YSAjIGl0IGlzIG5lY2Vzc2FyeSB0aGF0IGRlbHRhIGlzIHJldHVybmVkIGluIHRoZSB3YXkgaXQgd2FzIGFwcGxpZWQgb24gdGhlIGdsb2JhbCBkZWx0YS5cbiAgICAjIHNvIHRoYXQgeWpzIGNhbiBrbm93IGV4YWN0bHkgd2hhdCB3YXMgYXBwbGllZC5cblxuICAjIFwidW5kb1wiIGEgZGVsdGEgZnJvbSB0aGUgY29tcG9zaXRpb25fdmFsdWVcbiAgX3VuYXBwbHk6IChkZWx0YSktPlxuICAgIGZyb20gPSBAX21vZGVsLkhCLmdldE9wZXJhdGlvbiBkZWx0YS5mcm9tXG4gICAgdG8gPSBAX21vZGVsLkhCLmdldE9wZXJhdGlvbiBkZWx0YS50b1xuICAgIGlmIG5vdCAoZnJvbT8gYW5kIHRvPylcbiAgICAgIGNvbnNvbGUubG9nIFwid2Fzbid0IGFibGUgdG8gdW5hcHBseSB0aGUgc2VsZWN0aW9uLi5cIlxuICAgIGlmIGRlbHRhLnR5cGUgaXMgXCJzZWxlY3RcIlxuICAgICAgZGVsZXRlIGZyb20uc2VsZWN0aW9uXG4gICAgICBkZWxldGUgdG8uc2VsZWN0aW9uXG4gICAgZWxzZSBpZiBkZWx0YS50eXBlIGlzIFwidW5zZWxlY3RcIlxuICAgICAgIyAuLlxuICAgIGVsc2VcbiAgICAgIHRocm93IG5ldyBFcnJvciBcInVuc3VwcG9ydGVkIGRlbHRhIVwiXG5cbiAgIyB1cGRhdGUgdGhlIGdsb2JhbERlbHRhIHdpdGggZGVsdGFcblxuXG4gICMgc2VsZWN0IF9mcm9tXywgX3RvXyB3aXRoIGFuIF9hdHRyaWJ1dGVfXG4gIHNlbGVjdDogKGZyb20sIHRvLCBhdHRycyktPlxuICAgIGRlbHRhID0gIyBwcm9iYWJseSBub3QgYXMgZWFzeSBhcyB0aGlzXG4gICAgICBmcm9tOiBmcm9tLmdldFVpZCgpXG4gICAgICB0bzogdG8uZ2V0VWlkKClcbiAgICAgIGF0dHJzOiBhdHRyc1xuICAgICAgdHlwZTogXCJzZWxlY3RcIlxuXG4gICAgQF9tb2RlbC5hcHBseURlbHRhKGRlbHRhKVxuXG4gICMgdW5zZWxlY3QgX2Zyb21fLCBfdG9fIHdpdGggYW4gX2F0dHJpYnV0ZV9cbiAgdW5zZWxlY3Q6IChmcm9tLCB0bywgYXR0cnMpLT5cbiAgICBpZiB0eXBlb2YgYXR0cnMgaXMgXCJzdHJpbmdcIlxuICAgICAgYXR0cnMgPSBbYXR0cnNdXG4gICAgaWYgYXR0cnMuY29uc3RydWN0b3IgaXNudCBBcnJheVxuICAgICAgdGhyb3cgbmV3IEVycm9yIFwiWS5TZWxlY3Rpb25zLnByb3RvdHlwZS51bnNlbGVjdCBleHBlY3RzIGFuIEFycmF5IG9yIFN0cmluZyBhcyB0aGUgdGhpcmQgcGFyYW1ldGVyIChhdHRyaWJ1dGVzKSFcIlxuICAgIGRlbHRhID0gIyBwcm9iYWJseSBub3QgYXMgZWFzeSBhcyB0aGlzXG4gICAgICBmcm9tOiBmcm9tLmdldFVpZCgpXG4gICAgICB0bzogdG8uZ2V0VWlkKClcbiAgICAgIGF0dHJzOiBhdHRyc1xuICAgICAgdHlwZTogXCJ1bnNlbGVjdFwiXG5cbiAgICBAX21vZGVsLmFwcGx5RGVsdGEoZGVsdGEpXG5cbiAgIyAqIGdldCBhbGwgdGhlIHNlbGVjdGlvbnMgb2YgYSB5LWxpc3RcbiAgIyAqIHRoaXMgd2lsbCBhbHNvIHRlc3QgaWYgdGhlIHNlbGVjdGlvbnMgYXJlIHdlbGwgZm9ybWVkIChhZnRlciAkZnJvbSBmb2xsb3dzICR0byBmb2xsb3dzICRmcm9tIC4uKVxuICBnZXRTZWxlY3Rpb25zOiAobGlzdCktPlxuICAgIG8gPSBsaXN0LnJlZigwKVxuICAgIHNlbF9zdGFydCA9IG51bGxcbiAgICBwb3MgPSAwXG4gICAgcmVzdWx0ID0gW11cblxuICAgIHdoaWxlIG8ubmV4dF9jbD9cbiAgICAgIGlmIG8uc2VsZWN0aW9uP1xuICAgICAgICBpZiBvLnNlbGVjdGlvbi5mcm9tIGlzIG9cbiAgICAgICAgICBpZiBzZWxfc3RhcnQ/XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IgXCJGb3VuZCB0d28gY29uc2VjdXRpdmUgZnJvbSBlbGVtZW50cy4gVGhlIHNlbGVjdGlvbnMgYXJlIG5vIGxvbmdlciBzYWZlIHRvIHVzZSEgKGNvbnRhY3QgdGhlIG93bmVyIG9mIHRoZSByZXBvc2l0b3J5KVwiXG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgc2VsX3N0YXJ0ID0gcG9zXG4gICAgICAgIGlmIG8uc2VsZWN0aW9uLnRvIGlzIG9cbiAgICAgICAgICBpZiBzZWxfc3RhcnQ/XG4gICAgICAgICAgICBudW1iZXJfb2ZfYXR0cnMgPSAwXG4gICAgICAgICAgICBhdHRycyA9IHt9XG4gICAgICAgICAgICBmb3Igbix2IG9mIG8uc2VsZWN0aW9uLmF0dHJzXG4gICAgICAgICAgICAgIGF0dHJzW25dID0gdlxuICAgICAgICAgICAgICBudW1iZXJfb2ZfYXR0cnMrK1xuICAgICAgICAgICAgaWYgbnVtYmVyX29mX2F0dHJzID4gMFxuICAgICAgICAgICAgICByZXN1bHQucHVzaFxuICAgICAgICAgICAgICAgIGZyb206IHNlbF9zdGFydFxuICAgICAgICAgICAgICAgIHRvOiBwb3NcbiAgICAgICAgICAgICAgICBhdHRyczogYXR0cnNcbiAgICAgICAgICAgIHNlbF9zdGFydCA9IG51bGxcbiAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IgXCJGb3VuZCB0d28gY29uc2VjdXRpdmUgdG8gZWxlbWVudHMuIFRoZSBzZWxlY3Rpb25zIGFyZSBubyBsb25nZXIgc2FmZSB0byB1c2UhIChjb250YWN0IHRoZSBvd25lciBvZiB0aGUgcmVwb3NpdG9yeSlcIlxuICAgICAgICBlbHNlIGlmIG8uc2VsZWN0aW9uLmZyb20gaXNudCBvXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yIFwiVGhpcyByZWZlcmVuY2Ugc2hvdWxkIG5vdCBwb2ludCB0byB0aGlzIHNlbGVjdGlvbiwgYmVjYXVzZSB0aGUgc2VsZWN0aW9uIGRvZXMgbm90IHBvaW50IHRvIHRoZSByZWZlcmVuY2UuIFRoZSBzZWxlY3Rpb25zIGFyZSBubyBsb25nZXIgc2FmZSB0byB1c2UhIChjb250YWN0IHRoZSBvd25lciBvZiB0aGUgcmVwb3NpdG9yeSlcIlxuICAgICAgcG9zKytcbiAgICAgIG8gPSBvLm5leHRfY2xcbiAgICByZXR1cm4gcmVzdWx0XG5cbiAgb2JzZXJ2ZTogKGYpLT5cbiAgICBAX21vZGVsLm9ic2VydmUgZlxuXG5cbmlmIHdpbmRvdz9cbiAgaWYgd2luZG93Llk/XG4gICAgd2luZG93LlkuU2VsZWN0aW9ucyA9IFlTZWxlY3Rpb25zXG4gIGVsc2VcbiAgICB0aHJvdyBuZXcgRXJyb3IgXCJZb3UgbXVzdCBmaXJzdCBpbXBvcnQgWSFcIlxuXG5pZiBtb2R1bGU/XG4gIG1vZHVsZS5leHBvcnRzID0gWVNlbGVjdGlvbnNcblxuXG5cbiJdfQ==
