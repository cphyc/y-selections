(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var YSelections;

YSelections = (function() {
  function YSelections() {}

  YSelections.prototype._name = "Selections";

  YSelections.prototype._getModel = function(Y, Operation) {
    if (this._model == null) {
      this._model = new Operation.Composition(this, []).execute();
    }
    return this._model;
  };

  YSelections.prototype._setModel = function(_model) {
    this._model = _model;
  };

  YSelections.prototype._apply = function(delta) {
    var createSelection, cut_selection, end, extendSelection, from, o, selection, start, to;
    from = this._model.HB.getOperation(delta.from);
    to = this._model.HB.getOperation(delta.to);
    createSelection = function(from, to, attrs) {
      var n, new_attrs, v;
      new_attrs = {};
      for (n in attrs) {
        v = attrs[n];
        new_attrs[n] = v;
      }
      return {
        from: from,
        to: to,
        attrs: new_attrs
      };
    };
    extendSelection = function(selection, attrs) {
      var n, v, _results;
      _results = [];
      for (n in attrs) {
        v = attrs[n];
        _results.push(selection.attrs[n] = v);
      }
      return _results;
    };
    if (!((from != null) && (to != null))) {
      console.log("wasn't able to apply the selection..");
    }
    if (delta.type === "select") {
      cut_selection = function(reference, reference_name, direction, opposite_direction, opposite_reference, opposite_reference_name) {
        var new_selection, o, old_selection, opt_selection;
        if ((reference.selection != null) && reference.selection[reference_name] === reference) {
          return;
        }
        o = reference[direction];
        while ((o.selection == null) && (o.type !== "Delimiter")) {
          o = o[direction];
        }
        if ((o.selection == null) || o.selection[opposite_reference_name] === o) {
          return;
        }
        old_selection = o.selection;
        o = reference;
        while ((o.selection == null) && (o !== opposite_reference)) {
          o = o[direction];
        }
        if (o === old_selection[opposite_reference_name]) {
          new_selection = createSelection(reference, old_selection[opposite_reference_name], old_selection.attrs);
          extendSelection(new_selection, delta.attrs);
          old_selection[opposite_reference_name] = reference[direction];
          old_selection[opposite_reference_name].selection = old_selection;
          new_selection[reference_name].selection = new_selection;
          return new_selection[opposite_reference_name].selection = new_selection;
        } else {
          new_selection = createSelection(reference, opposite_reference, old_selection.attrs);
          extendSelection(new_selection, delta.attrs);
          opt_selection = createSelection(opposite_reference[opposite_direction], old_selection[opposite_reference_name], old_selection.attrs);
          old_selection[opposite_reference_name] = reference[direction];
          old_selection[opposite_reference_name].selection = old_selection;
          new_selection[reference_name].selection = new_selection;
          new_selection[opposite_reference_name].selection = new_selection;
          opt_selection[reference_name].selection = opt_selection;
          return opt_selection[opposite_reference_name].selection = opt_selection;
        }
      };
      ({
        cut_selection: function(reference, reference_name, direction, opposite_direction, opposite_reference, opposite_reference_name) {}
      });
      cut_selection(from, "from", "prev_cl", "next_cl", to, "to");
      cut_selection(to, "to", "next_cl", "prev_cl", from, "from");
      o = from;
      while (o !== to.next_cl) {
        if (o.selection != null) {
          extendSelection(o.selection, delta.attrs);
          o = o.selection.to.next_cl;
        } else {
          start = o;
          while (o !== to) {
            o = o.next_cl;
          }
          end = o;
          selection = createSelection(start, end, delta.attrs);
          start.selection = selection;
          end.selection = selection;
          o = o.next_cl;
        }
      }
    } else if (delta.type === "unselect") {

    } else {
      throw new Error("unsupported delta!");
    }
    return delta;
  };

  YSelections.prototype._unapply = function(delta) {
    var from, to;
    from = this._model.HB.getOperation(delta.from);
    to = this._model.HB.getOperation(delta.to);
    if (!((from != null) && (to != null))) {
      console.log("wasn't able to unapply the selection..");
    }
    if (delta.type === "select") {
      delete from.selection;
      return delete to.selection;
    } else if (delta.type === "unselect") {

    } else {
      throw new Error("unsupported delta!");
    }
  };

  YSelections.prototype.select = function(from, to, attrs) {
    var delta;
    delta = {
      from: from.getUid(),
      to: to.getUid(),
      attrs: attrs,
      type: "select"
    };
    return this._model.applyDelta(delta);
  };

  YSelections.prototype.unselect = function(from, to, attrs) {
    var delta;
    delta = {
      from: from.getUid(),
      to: to.getUid(),
      attrs: attrs,
      type: "unselect"
    };
    return this._model.applyDelta(delta);
  };

  YSelections.prototype.observe = function(f) {
    return this._model.observe(f);
  };

  return YSelections;

})();

if (typeof window !== "undefined" && window !== null) {
  if (window.Y != null) {
    window.Y.Selections = YSelections;
  } else {
    throw new Error("You must first import Y!");
  }
}

if (typeof module !== "undefined" && module !== null) {
  module.exports = YSelections;
}


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2NvZGlvL3dvcmtzcGFjZS95LXNlbGVjdGlvbnMvbm9kZV9tb2R1bGVzL2d1bHAtYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL2hvbWUvY29kaW8vd29ya3NwYWNlL3ktc2VsZWN0aW9ucy9saWIveS1zZWxlY3Rpb25zLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0dBLElBQUEsV0FBQTs7QUFBQTtBQUNlLEVBQUEscUJBQUEsR0FBQSxDQUFiOztBQUFBLHdCQUVBLEtBQUEsR0FBTyxZQUZQLENBQUE7O0FBQUEsd0JBSUEsU0FBQSxHQUFXLFNBQUMsQ0FBRCxFQUFJLFNBQUosR0FBQTtBQUNULElBQUEsSUFBTyxtQkFBUDtBQUNFLE1BQUEsSUFBQyxDQUFBLE1BQUQsR0FBYyxJQUFBLFNBQVMsQ0FBQyxXQUFWLENBQXNCLElBQXRCLEVBQXlCLEVBQXpCLENBQTRCLENBQUMsT0FBN0IsQ0FBQSxDQUFkLENBREY7S0FBQTtXQUVBLElBQUMsQ0FBQSxPQUhRO0VBQUEsQ0FKWCxDQUFBOztBQUFBLHdCQVNBLFNBQUEsR0FBVyxTQUFFLE1BQUYsR0FBQTtBQUFVLElBQVQsSUFBQyxDQUFBLFNBQUEsTUFBUSxDQUFWO0VBQUEsQ0FUWCxDQUFBOztBQUFBLHdCQVdBLE1BQUEsR0FBUSxTQUFDLEtBQUQsR0FBQTtBQUVOLFFBQUEsbUZBQUE7QUFBQSxJQUFBLElBQUEsR0FBTyxJQUFDLENBQUEsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFYLENBQXdCLEtBQUssQ0FBQyxJQUE5QixDQUFQLENBQUE7QUFBQSxJQUNBLEVBQUEsR0FBSyxJQUFDLENBQUEsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFYLENBQXdCLEtBQUssQ0FBQyxFQUE5QixDQURMLENBQUE7QUFBQSxJQUVBLGVBQUEsR0FBa0IsU0FBQyxJQUFELEVBQU8sRUFBUCxFQUFXLEtBQVgs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bkIsRUFQUTtFQUFBLENBakpWLENBQUE7O0FBQUEsd0JBMEpBLE9BQUEsR0FBUyxTQUFDLENBQUQsR0FBQTtXQUNQLElBQUMsQ0FBQSxNQUFNLENBQUMsT0FBUixDQUFnQixDQUFoQixFQURPO0VBQUEsQ0ExSlQsQ0FBQTs7cUJBQUE7O0lBREYsQ0FBQTs7QUErSkEsSUFBRyxnREFBSDtBQUNFLEVBQUEsSUFBRyxnQkFBSDtBQUNFLElBQUEsTUFBTSxDQUFDLENBQUMsQ0FBQyxVQUFULEdBQXNCLFdBQXRCLENBREY7R0FBQSxNQUFBO0FBR0UsVUFBVSxJQUFBLEtBQUEsQ0FBTSwwQkFBTixDQUFWLENBSEY7R0FERjtDQS9KQTs7QUFxS0EsSUFBRyxnREFBSDtBQUNFLEVBQUEsTUFBTSxDQUFDLE9BQVAsR0FBaUIsV0FBakIsQ0FERjtDQXJLQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpfXZhciBmPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChmLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGYsZi5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcblxuXG5jbGFzcyBZU2VsZWN0aW9uc1xuICBjb25zdHJ1Y3RvcjogKCktPlxuXG4gIF9uYW1lOiBcIlNlbGVjdGlvbnNcIlxuXG4gIF9nZXRNb2RlbDogKFksIE9wZXJhdGlvbikgLT5cbiAgICBpZiBub3QgQF9tb2RlbD9cbiAgICAgIEBfbW9kZWwgPSBuZXcgT3BlcmF0aW9uLkNvbXBvc2l0aW9uKEAsIFtdKS5leGVjdXRlKClcbiAgICBAX21vZGVsXG5cbiAgX3NldE1vZGVsOiAoQF9tb2RlbCktPlxuXG4gIF9hcHBseTogKGRlbHRhKS0+XG4gICAgIyBUT0RPOiBjdXJyZW50bHksIGFwcGxpZXMgdGhlIGRlbHRhIF9hcyBpc18uXG4gICAgZnJvbSA9IEBfbW9kZWwuSEIuZ2V0T3BlcmF0aW9uIGRlbHRhLmZyb21cbiAgICB0byA9IEBfbW9kZWwuSEIuZ2V0T3BlcmF0aW9uIGRlbHRhLnRvXG4gICAgY3JlYXRlU2VsZWN0aW9uID0gKGZyb20sIHRvLCBhdHRycyktPlxuICAgICAgbmV3X2F0dHJzID0ge31cbiAgICAgIGZvciBuLHYgb2YgYXR0cnNcbiAgICAgICAgbmV3X2F0dHJzW25dID0gdlxuICAgICAge1xuICAgICAgICBmcm9tOiBmcm9tXG4gICAgICAgIHRvOiB0b1xuICAgICAgICBhdHRyczogbmV3X2F0dHJzXG4gICAgICB9XG5cbiAgICBleHRlbmRTZWxlY3Rpb24gPSAoc2VsZWN0aW9uLCBhdHRycyktPlxuICAgICAgZm9yIG4sdiBvZiBhdHRyc1xuICAgICAgICBzZWxlY3Rpb24uYXR0cnNbbl0gPSB2XG5cbiAgICBpZiBub3QgKGZyb20/IGFuZCB0bz8pXG4gICAgICBjb25zb2xlLmxvZyBcIndhc24ndCBhYmxlIHRvIGFwcGx5IHRoZSBzZWxlY3Rpb24uLlwiXG4gICAgaWYgZGVsdGEudHlwZSBpcyBcInNlbGVjdFwiXG4gICAgICAjIEFsZ29yaXRobSBvdmVydmlldzpcbiAgICAgICMgMS4gY3V0IG9mZiB0aGUgc2VsZWN0aW9uIHRoYXQgaW50ZXJzZWN0cyB3aXRoIGZyb21cbiAgICAgICMgMi4gY3V0IG9mZiB0aGUgc2VsZWN0aW9uIHRoYXQgaW50ZXJzZWN0cyB3aXRoIHRvXG4gICAgICAjIDMuIGV4dGVuZCAvIGFkZCBzZWxlY3Rpb25zIGluIGJldHdlZW5cblxuICAgICAgIyBlLmcuICAgICAgICAgICBmcm9tICAgICAsIFwiZnJvbVwiICAgICAgICAsIFwicHJldl9jbFwiLCBcIm5leHRfY2xcIiAgICAgICAgICwgdG8gICAgICAgICAgICAgICAgLCBcInRvXCJcbiAgICAgIGN1dF9zZWxlY3Rpb24gPSAocmVmZXJlbmNlLCByZWZlcmVuY2VfbmFtZSwgZGlyZWN0aW9uLCBvcHBvc2l0ZV9kaXJlY3Rpb24sIG9wcG9zaXRlX3JlZmVyZW5jZSwgb3Bwb3NpdGVfcmVmZXJlbmNlX25hbWUpLT5cbiAgICAgICAgaWYgcmVmZXJlbmNlLnNlbGVjdGlvbj8gYW5kIHJlZmVyZW5jZS5zZWxlY3Rpb25bcmVmZXJlbmNlX25hbWVdIGlzIHJlZmVyZW5jZVxuICAgICAgICAgICMgZG9lcyBub3QgaW50ZXJzZWN0LCBiZWNhdXNlIHRoZSBzdGFydCBpcyBhbHJlYWR5IHNlbGVjdGVkXG4gICAgICAgICAgcmV0dXJuXG4gICAgICAgIG8gPSByZWZlcmVuY2VbZGlyZWN0aW9uXVxuICAgICAgICB3aGlsZSAobm90IG8uc2VsZWN0aW9uPykgYW5kIChvLnR5cGUgaXNudCBcIkRlbGltaXRlclwiKVxuICAgICAgICAgIG8gPSBvW2RpcmVjdGlvbl1cbiAgICAgICAgaWYgKG5vdCBvLnNlbGVjdGlvbj8pIG9yIG8uc2VsZWN0aW9uW29wcG9zaXRlX3JlZmVyZW5jZV9uYW1lXSBpcyBvXG4gICAgICAgICAgIyBubyBpbnRlcnNlY3Rpb25cbiAgICAgICAgICByZXR1cm5cblxuICAgICAgICAjIHRoaXMgaXMgYSByZWZlcmVuY2UgZm9yIHRoZSBzZWxlY3Rpb25zIHRoYXQgYXJlIGNyZWF0ZWQ6XG4gICAgICAgICMgb2xkIGlzIG91dGVyIChub3QgYmV0d2VlbiAkZnJvbSAkdG8pXG4gICAgICAgICMgbmV3IGlzIGlubmVyIChpbmJldHdlZW4gJGZyb20gJHRvKVxuICAgICAgICAjIG9wdCBpcyBvdXRlciBpbiBvcHBvc2l0ZV9kaXJlY3Rpb25cbiAgICAgICAgI1xuICAgICAgICBvbGRfc2VsZWN0aW9uID0gby5zZWxlY3Rpb25cblxuICAgICAgICAjIGNoZWNrIGlmIGZvdW5kIHNlbGVjdGlvbiBpbnRlcnNlY3RzIHdpdGggb3Bwb3NpdGVfcmVmZXJlbmNlXG4gICAgICAgIG8gPSByZWZlcmVuY2VcbiAgICAgICAgd2hpbGUgKG5vdCBvLnNlbGVjdGlvbj8pIGFuZCAobyBpc250IG9wcG9zaXRlX3JlZmVyZW5jZSlcbiAgICAgICAgICBvID0gb1tkaXJlY3Rpb25dXG4gICAgICAgIGlmIG8gaXMgb2xkX3NlbGVjdGlvbltvcHBvc2l0ZV9yZWZlcmVuY2VfbmFtZV1cbiAgICAgICAgICAjIG5vIGludGVyc2VjdGlvbiB3aXRoIG9wcG9zaXRlX3JlZmVyZW5jZSFcbiAgICAgICAgICAjIGNyZWF0ZSBuZXcgc2VsZWN0aW9uXG4gICAgICAgICAgbmV3X3NlbGVjdGlvbiA9IGNyZWF0ZVNlbGVjdGlvbiByZWZlcmVuY2UsIG9sZF9zZWxlY3Rpb25bb3Bwb3NpdGVfcmVmZXJlbmNlX25hbWVdLCBvbGRfc2VsZWN0aW9uLmF0dHJzXG4gICAgICAgICAgZXh0ZW5kU2VsZWN0aW9uIG5ld19zZWxlY3Rpb24sIGRlbHRhLmF0dHJzXG4gICAgICAgICAgIyB1cGRhdGUgb2xkIHNlbGVjdGlvblxuICAgICAgICAgIG9sZF9zZWxlY3Rpb25bb3Bwb3NpdGVfcmVmZXJlbmNlX25hbWVdID0gcmVmZXJlbmNlW2RpcmVjdGlvbl1cbiAgICAgICAgICAjIHVwZGF0ZSByZWZlcmVuY2VzXG4gICAgICAgICAgb2xkX3NlbGVjdGlvbltvcHBvc2l0ZV9yZWZlcmVuY2VfbmFtZV0uc2VsZWN0aW9uID0gb2xkX3NlbGVjdGlvblxuICAgICAgICAgIG5ld19zZWxlY3Rpb25bcmVmZXJlbmNlX25hbWVdLnNlbGVjdGlvbiA9IG5ld19zZWxlY3Rpb25cbiAgICAgICAgICBuZXdfc2VsZWN0aW9uW29wcG9zaXRlX3JlZmVyZW5jZV9uYW1lXS5zZWxlY3Rpb24gPSBuZXdfc2VsZWN0aW9uXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAjIHRoZXJlIGlzIGFuIGludGVyc2VjdGlvbiB3aXRoIG9wcG9zaXRlX3JlZmVyZW5jZSFcbiAgICAgICAgICAjIGNyZWF0ZSBuZXcgc2VsZWN0aW9uXG4gICAgICAgICAgbmV3X3NlbGVjdGlvbiA9IGNyZWF0ZVNlbGVjdGlvbiByZWZlcmVuY2UsIG9wcG9zaXRlX3JlZmVyZW5jZSwgb2xkX3NlbGVjdGlvbi5hdHRyc1xuICAgICAgICAgIGV4dGVuZFNlbGVjdGlvbiBuZXdfc2VsZWN0aW9uLCBkZWx0YS5hdHRyc1xuICAgICAgICAgIG9wdF9zZWxlY3Rpb24gPSBjcmVhdGVTZWxlY3Rpb24gb3Bwb3NpdGVfcmVmZXJlbmNlW29wcG9zaXRlX2RpcmVjdGlvbl0sIG9sZF9zZWxlY3Rpb25bb3Bwb3NpdGVfcmVmZXJlbmNlX25hbWVdLCBvbGRfc2VsZWN0aW9uLmF0dHJzXG4gICAgICAgICAgIyB1cGRhdGUgb2xkIHNlbGVjdGlvblxuICAgICAgICAgIG9sZF9zZWxlY3Rpb25bb3Bwb3NpdGVfcmVmZXJlbmNlX25hbWVdID0gcmVmZXJlbmNlW2RpcmVjdGlvbl1cbiAgICAgICAgICAjIHVwZGF0ZSByZWZlcmVuY2VzXG4gICAgICAgICAgb2xkX3NlbGVjdGlvbltvcHBvc2l0ZV9yZWZlcmVuY2VfbmFtZV0uc2VsZWN0aW9uID0gb2xkX3NlbGVjdGlvblxuICAgICAgICAgIG5ld19zZWxlY3Rpb25bcmVmZXJlbmNlX25hbWVdLnNlbGVjdGlvbiA9IG5ld19zZWxlY3Rpb25cbiAgICAgICAgICBuZXdfc2VsZWN0aW9uW29wcG9zaXRlX3JlZmVyZW5jZV9uYW1lXS5zZWxlY3Rpb24gPSBuZXdfc2VsZWN0aW9uXG4gICAgICAgICAgb3B0X3NlbGVjdGlvbltyZWZlcmVuY2VfbmFtZV0uc2VsZWN0aW9uID0gb3B0X3NlbGVjdGlvblxuICAgICAgICAgIG9wdF9zZWxlY3Rpb25bb3Bwb3NpdGVfcmVmZXJlbmNlX25hbWVdLnNlbGVjdGlvbiA9IG9wdF9zZWxlY3Rpb25cblxuICAgICAgIyAxLiBjdXQgb2ZmIHRoZSBzZWxlY3Rpb24gdGhhdCBpbnRlcnNlY3RzIHdpdGggZnJvbVxuICAgICAgIyBlLmcuICAgICAgICAgICBmcm9tICAgICAsIFwiZnJvbVwiICAgICAgICAsIFwicHJldl9jbFwiLCBcIm5leHRfY2xcIiAgICAgICAgICwgdG8gICAgICAgICAgICAgICAgLCBcInRvXCJcbiAgICAgIGN1dF9zZWxlY3Rpb24gOiAocmVmZXJlbmNlLCByZWZlcmVuY2VfbmFtZSwgZGlyZWN0aW9uLCBvcHBvc2l0ZV9kaXJlY3Rpb24sIG9wcG9zaXRlX3JlZmVyZW5jZSwgb3Bwb3NpdGVfcmVmZXJlbmNlX25hbWUpLT5cbiAgICAgIGN1dF9zZWxlY3Rpb24oZnJvbSwgXCJmcm9tXCIsIFwicHJldl9jbFwiLCBcIm5leHRfY2xcIiwgdG8gICwgXCJ0b1wiKVxuICAgICAgIyAyLiBjdXQgb2ZmIHRoZSBzZWxlY3Rpb24gdGhhdCBpbnRlcnNlY3RzIHdpdGggdG9cbiAgICAgIGN1dF9zZWxlY3Rpb24odG8gICwgXCJ0b1wiICAsIFwibmV4dF9jbFwiLCBcInByZXZfY2xcIiwgZnJvbSwgXCJmcm9tXCIpXG4gICAgICAjIDMuIGV4dGVuZCAvIGFkZCBzZWxlY3Rpb25zIGluIGJldHdlZW5cbiAgICAgIG8gPSBmcm9tXG4gICAgICB3aGlsZSBvIGlzbnQgdG8ubmV4dF9jbFxuICAgICAgICBpZiBvLnNlbGVjdGlvbj9cbiAgICAgICAgICAjIGp1c3QgZXh0ZW5kIHRoZSBleGlzdGluZyBzZWxlY3Rpb25cbiAgICAgICAgICBleHRlbmRTZWxlY3Rpb24gby5zZWxlY3Rpb24sIGRlbHRhLmF0dHJzXG4gICAgICAgICAgbyA9IG8uc2VsZWN0aW9uLnRvLm5leHRfY2xcbiAgICAgICAgZWxzZVxuICAgICAgICAgICMgY3JlYXRlIGEgbmV3IHNlbGVjdGlvbiAodW50aWwgeW91IGZpbmQgdGhlIG5leHQgb25lKVxuICAgICAgICAgIHN0YXJ0ID0gb1xuICAgICAgICAgIHdoaWxlIG8gaXNudCB0b1xuICAgICAgICAgICAgbyA9IG8ubmV4dF9jbFxuICAgICAgICAgIGVuZCA9IG9cbiAgICAgICAgICBzZWxlY3Rpb24gPSBjcmVhdGVTZWxlY3Rpb24gc3RhcnQsIGVuZCwgZGVsdGEuYXR0cnNcbiAgICAgICAgICBzdGFydC5zZWxlY3Rpb24gPSBzZWxlY3Rpb25cbiAgICAgICAgICBlbmQuc2VsZWN0aW9uID0gc2VsZWN0aW9uXG4gICAgICAgICAgbyA9IG8ubmV4dF9jbFxuXG4gICAgZWxzZSBpZiBkZWx0YS50eXBlIGlzIFwidW5zZWxlY3RcIlxuICAgICAgIyAuLlxuICAgIGVsc2VcbiAgICAgIHRocm93IG5ldyBFcnJvciBcInVuc3VwcG9ydGVkIGRlbHRhIVwiXG4gICAgcmV0dXJuIGRlbHRhICMgaXQgaXMgbmVjZXNzYXJ5IHRoYXQgZGVsdGEgaXMgcmV0dXJuZWQgaW4gdGhlIHdheSBpdCB3YXMgYXBwbGllZCBvbiB0aGUgZ2xvYmFsIGRlbHRhLlxuICAgICMgc28gdGhhdCB5anMgY2FuIGtub3cgZXhhY3RseSB3aGF0IHdhcyBhcHBsaWVkLlxuXG4gICMgXCJ1bmRvXCIgYSBkZWx0YSBmcm9tIHRoZSBjb21wb3NpdGlvbl92YWx1ZVxuICBfdW5hcHBseTogKGRlbHRhKS0+XG4gICAgZnJvbSA9IEBfbW9kZWwuSEIuZ2V0T3BlcmF0aW9uIGRlbHRhLmZyb21cbiAgICB0byA9IEBfbW9kZWwuSEIuZ2V0T3BlcmF0aW9uIGRlbHRhLnRvXG4gICAgaWYgbm90IChmcm9tPyBhbmQgdG8/KVxuICAgICAgY29uc29sZS5sb2cgXCJ3YXNuJ3QgYWJsZSB0byB1bmFwcGx5IHRoZSBzZWxlY3Rpb24uLlwiXG4gICAgaWYgZGVsdGEudHlwZSBpcyBcInNlbGVjdFwiXG4gICAgICBkZWxldGUgZnJvbS5zZWxlY3Rpb25cbiAgICAgIGRlbGV0ZSB0by5zZWxlY3Rpb25cbiAgICBlbHNlIGlmIGRlbHRhLnR5cGUgaXMgXCJ1bnNlbGVjdFwiXG4gICAgICAjIC4uXG4gICAgZWxzZVxuICAgICAgdGhyb3cgbmV3IEVycm9yIFwidW5zdXBwb3J0ZWQgZGVsdGEhXCJcblxuICAjIHVwZGF0ZSB0aGUgZ2xvYmFsRGVsdGEgd2l0aCBkZWx0YVxuXG5cbiAgIyBzZWxlY3QgX2Zyb21fLCBfdG9fIHdpdGggYW4gX2F0dHJpYnV0ZV9cbiAgc2VsZWN0OiAoZnJvbSwgdG8sIGF0dHJzKS0+XG4gICAgZGVsdGEgPSAjIHByb2JhYmx5IG5vdCBhcyBlYXN5IGFzIHRoaXNcbiAgICAgIGZyb206IGZyb20uZ2V0VWlkKClcbiAgICAgIHRvOiB0by5nZXRVaWQoKVxuICAgICAgYXR0cnM6IGF0dHJzXG4gICAgICB0eXBlOiBcInNlbGVjdFwiXG5cbiAgICBAX21vZGVsLmFwcGx5RGVsdGEoZGVsdGEpXG5cbiAgIyB1bnNlbGVjdCBfZnJvbV8sIF90b18gd2l0aCBhbiBfYXR0cmlidXRlX1xuICB1bnNlbGVjdDogKGZyb20sIHRvLCBhdHRycyktPlxuICAgIGRlbHRhID0gIyBwcm9iYWJseSBub3QgYXMgZWFzeSBhcyB0aGlzXG4gICAgICBmcm9tOiBmcm9tLmdldFVpZCgpXG4gICAgICB0bzogdG8uZ2V0VWlkKClcbiAgICAgIGF0dHJzOiBhdHRyc1xuICAgICAgdHlwZTogXCJ1bnNlbGVjdFwiXG5cbiAgICBAX21vZGVsLmFwcGx5RGVsdGEoZGVsdGEpXG5cbiAgb2JzZXJ2ZTogKGYpLT5cbiAgICBAX21vZGVsLm9ic2VydmUgZlxuXG5cbmlmIHdpbmRvdz9cbiAgaWYgd2luZG93Llk/XG4gICAgd2luZG93LlkuU2VsZWN0aW9ucyA9IFlTZWxlY3Rpb25zXG4gIGVsc2VcbiAgICB0aHJvdyBuZXcgRXJyb3IgXCJZb3UgbXVzdCBmaXJzdCBpbXBvcnQgWSFcIlxuXG5pZiBtb2R1bGU/XG4gIG1vZHVsZS5leHBvcnRzID0gWVNlbGVjdGlvbnNcblxuXG5cblxuXG5cbiJdfQ==
