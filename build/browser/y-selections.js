(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var YSelections;

YSelections = (function() {
  function YSelections() {
    this._listeners = [];
  }

  YSelections.prototype._name = "Selections";

  YSelections.prototype._getModel = function(Y, Operation) {
    if (this._model == null) {
      this._model = new Operation.Composition(this, []).execute();
    }
    return this._model;
  };

  YSelections.prototype._setModel = function(_model) {
    this._model = _model;
  };

  YSelections.prototype._apply = function(delta) {
    var attr_list, createSelection, cut_off_from, cut_off_to, end, extendSelection, from, l, n, o, observer_call, selection, start, to, undos, v, _i, _len, _ref, _ref1;
    undos = [];
    from = this._model.HB.getOperation(delta.from);
    to = this._model.HB.getOperation(delta.to);
    observer_call = {
      from: from,
      to: to,
      type: delta.type,
      attrs: delta.attrs
    };
    _ref = this._listeners;
    for (_i = 0, _len = _ref.length; _i < _len; _i++) {
      l = _ref[_i];
      l.call(this, observer_call);
    }
    createSelection = function(from, to, attrs) {
      var n, new_attrs, v;
      new_attrs = {};
      for (n in attrs) {
        v = attrs[n];
        new_attrs[n] = v;
      }
      return {
        from: from,
        to: to,
        attrs: new_attrs
      };
    };
    extendSelection = function(selection) {
      var n, undo_attrs, undo_attrs_list, undo_need_select, undo_need_unselect, v, _j, _len1, _ref1, _ref2;
      if (delta.type === "unselect") {
        undo_attrs = {};
        _ref1 = delta.attrs;
        for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {
          n = _ref1[_j];
          if (selection.attrs[n] != null) {
            undo_attrs[n] = selection.attrs[n];
          }
          delete selection.attrs[n];
        }
        return undos.push({
          from: delta.from,
          to: delta.to,
          attrs: undo_attrs,
          type: "select"
        });
      } else {
        undo_attrs = {};
        undo_attrs_list = [];
        undo_need_unselect = false;
        undo_need_select = false;
        _ref2 = delta.attrs;
        for (n in _ref2) {
          v = _ref2[n];
          if (selection.attrs[n] != null) {
            undo_attrs[n] = selection.attrs[n];
            undo_need_select = true;
          } else {
            undo_attrs_list.push(n);
            undo_need_unselect = true;
          }
          selection.attrs[n] = v;
        }
        if (undo_need_select) {
          undos.push({
            from: delta.from,
            to: delta.to,
            attrs: undo_attrs,
            type: "select"
          });
        }
        if (undo_need_unselect) {
          return undos.push({
            from: delta.from,
            to: delta.to,
            attrs: undo_attrs_list,
            type: "unselect"
          });
        }
      }
    };
    if (!((from != null) && (to != null))) {
      console.log("wasn't able to apply the selection..");
    }
    cut_off_from = function() {
      var new_selection, o, old_selection, opt_selection;
      if ((from.selection != null) && from.selection.from === from) {
        return;
      }
      o = from.prev_cl;
      while ((o.selection == null) && (o.type !== "Delimiter")) {
        o = o.prev_cl;
      }
      if ((o.selection == null) || o.selection.to === o) {
        return;
      }
      old_selection = o.selection;
      o = from;
      while ((o !== old_selection.to) && (o !== to)) {
        o = o.next_cl;
      }
      if (o === old_selection.to) {
        new_selection = createSelection(from, old_selection.to, old_selection.attrs);
        old_selection.to = from.prev_cl;
        old_selection.to.selection = old_selection;
        new_selection.from.selection = new_selection;
        return new_selection.to.selection = new_selection;
      } else {
        new_selection = createSelection(from, to, old_selection.attrs);
        opt_selection = createSelection(to.next_cl, old_selection.to, old_selection.attrs);
        old_selection.to = from.prev_cl;
        old_selection.to.selection = old_selection;
        opt_selection.from.selection = opt_selection;
        opt_selection.to.selection = opt_selection;
        new_selection.from.selection = new_selection;
        return new_selection.to.selection = new_selection;
      }
    };
    cut_off_from();
    cut_off_to = function() {
      var new_selection, o, old_selection;
      if ((to.selection != null) && to.selection.to === to) {
        return;
      }
      o = to;
      while ((o.selection == null) && (o !== from)) {
        o = o.prev_cl;
      }
      if ((o.selection == null) || o.selection["to"] === o) {
        return;
      }
      old_selection = o.selection;
      new_selection = createSelection(to.next_cl, old_selection.to, old_selection.attrs);
      old_selection.to = to;
      old_selection.to.selection = old_selection;
      new_selection.from.selection = new_selection;
      return new_selection.to.selection = new_selection;
    };
    cut_off_to();
    o = from;
    while (o !== to.next_cl) {
      if (o.selection != null) {
        console.log("1");
        extendSelection(o.selection, delta);
        o = o.selection.to.next_cl;
      } else {
        console.log("2");
        start = o;
        while ((o.next_cl.selection == null) && (o !== to)) {
          o = o.next_cl;
        }
        end = o;
        if (delta.type !== "unselect") {
          attr_list = [];
          _ref1 = delta.attrs;
          for (n in _ref1) {
            v = _ref1[n];
            attr_list.push(n);
          }
          undos.push({
            from: start.getUid(),
            to: end.getUid(),
            attrs: attr_list,
            type: "unselect"
          });
          selection = createSelection(start, end, delta.attrs);
          start.selection = selection;
          end.selection = selection;
        }
        o = o.next_cl;
      }
    }
    return delta;
  };

  YSelections.prototype._unapply = function(deltas) {
    var delta, _i, _len;
    for (_i = 0, _len = deltas.length; _i < _len; _i++) {
      delta = deltas[_i];
      this._apply(delta);
    }
  };

  YSelections.prototype.select = function(from, to, attrs) {
    var delta;
    delta = {
      from: from.getUid(),
      to: to.getUid(),
      attrs: attrs,
      type: "select"
    };
    return this._model.applyDelta(delta);
  };

  YSelections.prototype.unselect = function(from, to, attrs) {
    var delta;
    if (typeof attrs === "string") {
      attrs = [attrs];
    }
    if (attrs.constructor !== Array) {
      throw new Error("Y.Selections.prototype.unselect expects an Array or String as the third parameter (attributes)!");
    }
    delta = {
      from: from.getUid(),
      to: to.getUid(),
      attrs: attrs,
      type: "unselect"
    };
    return this._model.applyDelta(delta);
  };

  YSelections.prototype.getSelections = function(list) {
    var attrs, n, number_of_attrs, o, pos, result, sel_start, v, _ref;
    o = list.ref(0);
    sel_start = null;
    pos = 0;
    result = [];
    while (o.next_cl != null) {
      if (o.selection != null) {
        if (o.selection.from === o) {
          if (sel_start != null) {
            throw new Error("Found two consecutive from elements. The selections are no longer safe to use! (contact the owner of the repository)");
          } else {
            sel_start = pos;
          }
        }
        if (o.selection.to === o) {
          if (sel_start != null) {
            number_of_attrs = 0;
            attrs = {};
            _ref = o.selection.attrs;
            for (n in _ref) {
              v = _ref[n];
              attrs[n] = v;
              number_of_attrs++;
            }
            if (number_of_attrs > 0) {
              result.push({
                from: sel_start,
                to: pos,
                attrs: attrs
              });
            }
            sel_start = null;
          } else {
            throw new Error("Found two consecutive to elements. The selections are no longer safe to use! (contact the owner of the repository)");
          }
        } else if (o.selection.from !== o) {
          throw new Error("This reference should not point to this selection, because the selection does not point to the reference. The selections are no longer safe to use! (contact the owner of the repository)");
        }
      }
      pos++;
      o = o.next_cl;
    }
    return result;
  };

  YSelections.prototype.observe = function(f) {
    return this._listeners.push(f);
  };

  YSelections.prototype.unobserve = function(f) {
    return this._listeners = this._listeners.filter(function(g) {
      return f !== g;
    });
  };

  return YSelections;

})();

if (typeof window !== "undefined" && window !== null) {
  if (window.Y != null) {
    window.Y.Selections = YSelections;
  } else {
    throw new Error("You must first import Y!");
  }
}

if (typeof module !== "undefined" && module !== null) {
  module.exports = YSelections;
}


},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2NvZGlvL3dvcmtzcGFjZS95LXNlbGVjdGlvbnMvbm9kZV9tb2R1bGVzL2d1bHAtYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwiL2hvbWUvY29kaW8vd29ya3NwYWNlL3ktc2VsZWN0aW9ucy9saWIveS1zZWxlY3Rpb25zLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0dBLElBQUEsV0FBQTs7QUFBQTtBQUNlLEVBQUEscUJBQUEsR0FBQTtBQUNYLElBQUEsSUFBQyxDQUFBLFVBQUQsR0FBYyxFQUFkLENBRFc7RUFBQSxDQUFiOztBQUFBLHdCQUdBLEtBQUEsR0FBTyxZQUhQLENBQUE7O0FBQUEsd0JBS0EsU0FBQSxHQUFXLFNBQUMsQ0FBRCxFQUFJLFNBQUosR0FBQTtBQUNULElBQUEsSUFBTyxtQkFBUDtBQUNFLE1BQUEsSUFBQyxDQUFBLE1BQUQsR0FBYyxJQUFBLFNBQVMsQ0FBQyxXQUFWLENBQXNCLElBQXRCLEVBQXlCLEVBQXpCLENBQTRCLENBQUMsT0FBN0IsQ0FBQSxDQUFkLENBREY7S0FBQTtXQUVBLElBQUMsQ0FBQSxPQUhRO0VBQUEsQ0FMWCxDQUFBOztBQUFBLHdCQVVBLFNBQUEsR0FBVyxTQUFFLE1BQUYsR0FBQTtBQUFVLElBQVQsSUFBQyxDQUFBLFNBQUEsTUFBUSxDQUFWO0VBQUEsQ0FWWCxDQUFBOztBQUFBLHdCQVlBLE1BQUEsR0FBUSxTQUFDLEtBQUQsR0FBQTtBQUNOLFFBQUEsK0pBQUE7QUFBQSxJQUFBLEtBQUEsR0FBUSxFQUFSLENBQUE7QUFBQSxJQUNBLElBQUEsR0FBTyxJQUFDLENBQUEsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFYLENBQXdCLEtBQUssQ0FBQyxJQUE5QixDQURQLENBQUE7QUFBQSxJQUVBLEVBQUEsR0FBSyxJQUFDLENBQUEsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFYLENBQXdCLEtB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QjtBQUNILGdCQUFVLElBQUEsS0FBQSxDQUFNLDJMQUFOLENBQVYsQ0FERztTQXJCUDtPQUFBO0FBQUEsTUF1QkEsR0FBQSxFQXZCQSxDQUFBO0FBQUEsTUF3QkEsQ0FBQSxHQUFJLENBQUMsQ0FBQyxPQXhCTixDQURGO0lBQUEsQ0FMQTtBQStCQSxXQUFPLE1BQVAsQ0FoQ2E7RUFBQSxDQWxRZixDQUFBOztBQUFBLHdCQW9TQSxPQUFBLEdBQVMsU0FBQyxDQUFELEdBQUE7V0FDUCxJQUFDLENBQUEsVUFBVSxDQUFDLElBQVosQ0FBaUIsQ0FBakIsRUFETztFQUFBLENBcFNULENBQUE7O0FBQUEsd0JBdVNBLFNBQUEsR0FBVyxTQUFDLENBQUQsR0FBQTtXQUNULElBQUMsQ0FBQSxVQUFELEdBQWMsSUFBQyxDQUFBLFVBQVUsQ0FBQyxNQUFaLENBQW1CLFNBQUMsQ0FBRCxHQUFBO2FBQy9CLENBQUEsS0FBSyxFQUQwQjtJQUFBLENBQW5CLEVBREw7RUFBQSxDQXZTWCxDQUFBOztxQkFBQTs7SUFERixDQUFBOztBQTZTQSxJQUFHLGdEQUFIO0FBQ0UsRUFBQSxJQUFHLGdCQUFIO0FBQ0UsSUFBQSxNQUFNLENBQUMsQ0FBQyxDQUFDLFVBQVQsR0FBc0IsV0FBdEIsQ0FERjtHQUFBLE1BQUE7QUFHRSxVQUFVLElBQUEsS0FBQSxDQUFNLDBCQUFOLENBQVYsQ0FIRjtHQURGO0NBN1NBOztBQW1UQSxJQUFHLGdEQUFIO0FBQ0UsRUFBQSxNQUFNLENBQUMsT0FBUCxHQUFpQixXQUFqQixDQURGO0NBblRBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlxuXG5cbmNsYXNzIFlTZWxlY3Rpb25zXG4gIGNvbnN0cnVjdG9yOiAoKS0+XG4gICAgQF9saXN0ZW5lcnMgPSBbXVxuXG4gIF9uYW1lOiBcIlNlbGVjdGlvbnNcIlxuXG4gIF9nZXRNb2RlbDogKFksIE9wZXJhdGlvbikgLT5cbiAgICBpZiBub3QgQF9tb2RlbD9cbiAgICAgIEBfbW9kZWwgPSBuZXcgT3BlcmF0aW9uLkNvbXBvc2l0aW9uKEAsIFtdKS5leGVjdXRlKClcbiAgICBAX21vZGVsXG5cbiAgX3NldE1vZGVsOiAoQF9tb2RlbCktPlxuXG4gIF9hcHBseTogKGRlbHRhKS0+XG4gICAgdW5kb3MgPSBbXSAjIGxpc3Qgb2YgZGVsdGFzIHRoYXQgYXJlIG5lY2Vzc2FyeSB0byB1bmRvIHRoZSBjaGFuZ2VcbiAgICBmcm9tID0gQF9tb2RlbC5IQi5nZXRPcGVyYXRpb24gZGVsdGEuZnJvbVxuICAgIHRvID0gQF9tb2RlbC5IQi5nZXRPcGVyYXRpb24gZGVsdGEudG9cbiAgICAjIG5vdGlmeSBsaXN0ZW5lcnM6XG4gICAgb2JzZXJ2ZXJfY2FsbCA9XG4gICAgICBmcm9tOiBmcm9tXG4gICAgICB0bzogdG9cbiAgICAgIHR5cGU6IGRlbHRhLnR5cGVcbiAgICAgIGF0dHJzOiBkZWx0YS5hdHRyc1xuICAgIGZvciBsIGluIEBfbGlzdGVuZXJzXG4gICAgICBsLmNhbGwgdGhpcywgb2JzZXJ2ZXJfY2FsbFxuICAgIGNyZWF0ZVNlbGVjdGlvbiA9IChmcm9tLCB0bywgYXR0cnMpLT5cbiAgICAgIG5ld19hdHRycyA9IHt9XG4gICAgICBmb3Igbix2IG9mIGF0dHJzXG4gICAgICAgIG5ld19hdHRyc1tuXSA9IHZcbiAgICAgIHtcbiAgICAgICAgZnJvbTogZnJvbVxuICAgICAgICB0bzogdG9cbiAgICAgICAgYXR0cnM6IG5ld19hdHRyc1xuICAgICAgfVxuXG4gICAgZXh0ZW5kU2VsZWN0aW9uID0gKHNlbGVjdGlvbiktPlxuICAgICAgaWYgZGVsdGEudHlwZSBpcyBcInVuc2VsZWN0XCJcbiAgICAgICAgdW5kb19hdHRycyA9IHt9XG4gICAgICAgIGZvciBuIGluIGRlbHRhLmF0dHJzXG4gICAgICAgICAgaWYgc2VsZWN0aW9uLmF0dHJzW25dP1xuICAgICAgICAgICAgdW5kb19hdHRyc1tuXSA9IHNlbGVjdGlvbi5hdHRyc1tuXVxuICAgICAgICAgIGRlbGV0ZSBzZWxlY3Rpb24uYXR0cnNbbl1cbiAgICAgICAgdW5kb3MucHVzaFxuICAgICAgICAgIGZyb206IGRlbHRhLmZyb21cbiAgICAgICAgICB0bzogZGVsdGEudG9cbiAgICAgICAgICBhdHRyczogdW5kb19hdHRyc1xuICAgICAgICAgIHR5cGU6IFwic2VsZWN0XCJcbiAgICAgIGVsc2VcbiAgICAgICAgdW5kb19hdHRycyA9IHt9ICMgZm9yIHVuZG8gc2VsZWN0aW9uIChvdmVyd3JpdGUgb2YgZXhpc3Rpbmcgc2VsZWN0aW9uKVxuICAgICAgICB1bmRvX2F0dHJzX2xpc3QgPSBbXSAjIGZvciB1bmRvIHNlbGVjdGlvbiAobm90IG92ZXJ3cml0ZSlcbiAgICAgICAgdW5kb19uZWVkX3Vuc2VsZWN0ID0gZmFsc2VcbiAgICAgICAgdW5kb19uZWVkX3NlbGVjdCA9IGZhbHNlXG4gICAgICAgIGZvciBuLHYgb2YgZGVsdGEuYXR0cnNcbiAgICAgICAgICBpZiBzZWxlY3Rpb24uYXR0cnNbbl0/XG4gICAgICAgICAgICB1bmRvX2F0dHJzW25dID0gc2VsZWN0aW9uLmF0dHJzW25dXG4gICAgICAgICAgICB1bmRvX25lZWRfc2VsZWN0ID0gdHJ1ZVxuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHVuZG9fYXR0cnNfbGlzdC5wdXNoIG5cbiAgICAgICAgICAgIHVuZG9fbmVlZF91bnNlbGVjdCA9IHRydWVcbiAgICAgICAgICBzZWxlY3Rpb24uYXR0cnNbbl0gPSB2XG4gICAgICAgIGlmIHVuZG9fbmVlZF9zZWxlY3RcbiAgICAgICAgICB1bmRvcy5wdXNoXG4gICAgICAgICAgICBmcm9tOiBkZWx0YS5mcm9tXG4gICAgICAgICAgICB0bzogZGVsdGEudG9cbiAgICAgICAgICAgIGF0dHJzOiB1bmRvX2F0dHJzXG4gICAgICAgICAgICB0eXBlOiBcInNlbGVjdFwiXG4gICAgICAgIGlmIHVuZG9fbmVlZF91bnNlbGVjdFxuICAgICAgICAgIHVuZG9zLnB1c2hcbiAgICAgICAgICAgIGZyb206IGRlbHRhLmZyb21cbiAgICAgICAgICAgIHRvOiBkZWx0YS50b1xuICAgICAgICAgICAgYXR0cnM6IHVuZG9fYXR0cnNfbGlzdFxuICAgICAgICAgICAgdHlwZTogXCJ1bnNlbGVjdFwiXG5cbiAgICBpZiBub3QgKGZyb20/IGFuZCB0bz8pXG4gICAgICBjb25zb2xlLmxvZyBcIndhc24ndCBhYmxlIHRvIGFwcGx5IHRoZSBzZWxlY3Rpb24uLlwiXG4gICAgIyBBbGdvcml0aG0gb3ZlcnZpZXc6XG4gICAgIyAxLiBjdXQgb2ZmIHRoZSBzZWxlY3Rpb24gdGhhdCBpbnRlcnNlY3RzIHdpdGggZnJvbVxuICAgICMgMi4gY3V0IG9mZiB0aGUgc2VsZWN0aW9uIHRoYXQgaW50ZXJzZWN0cyB3aXRoIHRvXG4gICAgIyAzLiBleHRlbmQgLyBhZGQgc2VsZWN0aW9ucyBpbmJldHdlZW5cblxuICAgICNcbiAgICAjIyMjIDEuIGN1dCBvZmYgdGhlIHNlbGVjdGlvbiB0aGF0IGludGVyc2VjdHMgd2l0aCBmcm9tXG4gICAgI1xuICAgIGN1dF9vZmZfZnJvbSA9ICgpLT5cbiAgICAgICMgY2hlY2sgaWYgYSBzZWxlY3Rpb24gKHRvIHRoZSBsZWZ0IG9mICRmcm9tKSBpbnRlcnNlY3RzIHdpdGggJGZyb21cbiAgICAgIGlmIGZyb20uc2VsZWN0aW9uPyBhbmQgZnJvbS5zZWxlY3Rpb24uZnJvbSBpcyBmcm9tXG4gICAgICAgICMgZG9lcyBub3QgaW50ZXJzZWN0LCBiZWNhdXNlIHRoZSBzdGFydCBpcyBhbHJlYWR5IHNlbGVjdGVkXG4gICAgICAgIHJldHVyblxuICAgICAgIyBmaW5kIGZpcnN0IHNlbGVjdGlvbiB0byB0aGUgbGVmdFxuICAgICAgbyA9IGZyb20ucHJldl9jbFxuICAgICAgd2hpbGUgKG5vdCBvLnNlbGVjdGlvbj8pIGFuZCAoby50eXBlIGlzbnQgXCJEZWxpbWl0ZXJcIilcbiAgICAgICAgbyA9IG8ucHJldl9jbFxuICAgICAgaWYgKG5vdCBvLnNlbGVjdGlvbj8pIG9yIG8uc2VsZWN0aW9uLnRvIGlzIG9cbiAgICAgICAgIyBubyBpbnRlcnNlY3Rpb25cbiAgICAgICAgcmV0dXJuXG4gICAgICAjIFdlIGZvdW5kIGEgc2VsZWN0aW9uIHRoYXQgaW50ZXJzZWN0cyB3aXRoICRmcm9tLlxuICAgICAgIyBOb3cgd2UgaGF2ZSB0byBjaGVjayBpZiBpdCBhbHNvIGludGVyc2VjdHMgd2l0aCAkdG8uXG4gICAgICAjIFRoZW4gd2UgY3V0IGl0IGluIHN1Y2ggYSB3YXksXG4gICAgICAjIHRoYXQgdGhlIHNlbGVjdGlvbiBkb2VzIG5vdCBpbnRlcnNlY3Qgd2l0aCAkZnJvbSBhbmQgJHRvIGFueW1vcmUuXG5cbiAgICAgICMgdGhpcyBpcyBhIHJlZmVyZW5jZSBmb3IgdGhlIHNlbGVjdGlvbnMgdGhhdCBhcmUgY3JlYXRlZC9tb2RpZmllZDpcbiAgICAgICMgb2xkX3NlbGVjdGlvbiBpcyBvdXRlciAobm90IGJldHdlZW4gJGZyb20gJHRvKVxuICAgICAgIyAgIC0gd2lsbCBiZSBjaGFuZ2VkIGluIHN1Y2ggYSB3YXkgdGhhdCBpdCBpcyB0byB0aGUgbGVmdCBvZiAkZnJvbVxuICAgICAgIyBuZXdfc2VsZWN0aW9uIGlzIGlubmVyIChpbmJldHdlZW4gJGZyb20gJHRvKVxuICAgICAgIyAgIC0gY3JlYXRlZCwgcmlnaHQgYWZ0ZXIgJGZyb21cbiAgICAgICMgb3B0X3NlbGVjdGlvbiBpcyBvdXRlciAoYWZ0ZXIgJHRvKVxuICAgICAgIyAgIC0gY3JlYXRlZCAoaWYgbmVjZXNzYXJ5KSwgcmlnaHQgYWZ0ZXIgJHRvXG4gICAgICBvbGRfc2VsZWN0aW9uID0gby5zZWxlY3Rpb25cblxuICAgICAgIyBjaGVjayBpZiBmb3VuZCBzZWxlY3Rpb24gYWxzbyBpbnRlcnNlY3RzIHdpdGggJHRvXG4gICAgICAjICogc3RhcnRpbmcgZnJvbSAkZnJvbSwgZ28gdG8gdGhlIHJpZ2h0IHVudGlsIHlvdSBmb3VuZCBlaXRoZXIgJHRvIG9yIG9sZF9zZWxlY3Rpb24udG9cbiAgICAgICMgKiogaWYgJHRvOiBubyBpbnRlcnNlY3Rpb24gd2l0aCAkdG9cbiAgICAgICMgKiogaWYgJG9sZF9zZWxlY3Rpb24udG86IGludGVyc2VjdGlvbiB3aXRoICR0byFcbiAgICAgIG8gPSBmcm9tXG4gICAgICB3aGlsZSAobyBpc250IG9sZF9zZWxlY3Rpb24udG8pIGFuZCAobyBpc250IHRvKVxuICAgICAgICBvID0gby5uZXh0X2NsXG5cbiAgICAgIGlmIG8gaXMgb2xkX3NlbGVjdGlvbi50b1xuICAgICAgICAjIG5vIGludGVyc2VjdGlvbiB3aXRoIHRvIVxuICAgICAgICAjIGNyZWF0ZSAkbmV3X3NlbGVjdGlvblxuICAgICAgICBuZXdfc2VsZWN0aW9uID0gY3JlYXRlU2VsZWN0aW9uIGZyb20sIG9sZF9zZWxlY3Rpb24udG8sIG9sZF9zZWxlY3Rpb24uYXR0cnNcblxuICAgICAgICAjIHVwZGF0ZSByZWZlcmVuY2VzXG4gICAgICAgIG9sZF9zZWxlY3Rpb24udG8gPSBmcm9tLnByZXZfY2xcbiAgICAgICAgIyB1cGRhdGUgcmVmZXJlbmNlcyAocG9pbnRlcnMgdG8gcmVzcGVjdGl2ZSBzZWxlY3Rpb25zKVxuICAgICAgICBvbGRfc2VsZWN0aW9uLnRvLnNlbGVjdGlvbiA9IG9sZF9zZWxlY3Rpb25cblxuICAgICAgICBuZXdfc2VsZWN0aW9uLmZyb20uc2VsZWN0aW9uID0gbmV3X3NlbGVjdGlvblxuICAgICAgICBuZXdfc2VsZWN0aW9uLnRvLnNlbGVjdGlvbiA9IG5ld19zZWxlY3Rpb25cbiAgICAgIGVsc2VcbiAgICAgICAgIyB0aGVyZSBpcyBhbiBpbnRlcnNlY3Rpb24gd2l0aCB0byFcblxuICAgICAgICAjIGNyZWF0ZSAkbmV3X3NlbGVjdGlvblxuICAgICAgICBuZXdfc2VsZWN0aW9uID0gY3JlYXRlU2VsZWN0aW9uIGZyb20sIHRvLCBvbGRfc2VsZWN0aW9uLmF0dHJzXG5cbiAgICAgICAgIyBjcmVhdGUgJG9wdF9zZWxlY3Rpb25cbiAgICAgICAgb3B0X3NlbGVjdGlvbiA9IGNyZWF0ZVNlbGVjdGlvbiB0by5uZXh0X2NsLCBvbGRfc2VsZWN0aW9uLnRvLCBvbGRfc2VsZWN0aW9uLmF0dHJzXG5cbiAgICAgICAgIyB1cGRhdGUgcmVmZXJlbmNlc1xuICAgICAgICBvbGRfc2VsZWN0aW9uLnRvID0gZnJvbS5wcmV2X2NsXG4gICAgICAgICMgdXBkYXRlIHJlZmVyZW5jZXMgKHBvaW50ZXJzIHRvIHJlc3BlY3RpdmUgc2VsZWN0aW9ucylcbiAgICAgICAgb2xkX3NlbGVjdGlvbi50by5zZWxlY3Rpb24gPSBvbGRfc2VsZWN0aW9uXG5cbiAgICAgICAgb3B0X3NlbGVjdGlvbi5mcm9tLnNlbGVjdGlvbiA9IG9wdF9zZWxlY3Rpb25cbiAgICAgICAgb3B0X3NlbGVjdGlvbi50by5zZWxlY3Rpb24gPSBvcHRfc2VsZWN0aW9uXG5cbiAgICAgICAgbmV3X3NlbGVjdGlvbi5mcm9tLnNlbGVjdGlvbiA9IG5ld19zZWxlY3Rpb25cbiAgICAgICAgbmV3X3NlbGVjdGlvbi50by5zZWxlY3Rpb24gPSBuZXdfc2VsZWN0aW9uXG5cblxuICAgIGN1dF9vZmZfZnJvbSgpXG5cbiAgICAjIDIuIGN1dCBvZmYgdGhlIHNlbGVjdGlvbiB0aGF0IGludGVyc2VjdHMgd2l0aCAkdG9cbiAgICBjdXRfb2ZmX3RvID0gKCktPlxuICAgICAgIyBjaGVjayBpZiBhIHNlbGVjdGlvbiAodG8gdGhlIGxlZnQgb2YgJHRvKSBpbnRlcnNlY3RzIHdpdGggJHRvXG4gICAgICBpZiB0by5zZWxlY3Rpb24/IGFuZCB0by5zZWxlY3Rpb24udG8gaXMgdG9cbiAgICAgICAgIyBkb2VzIG5vdCBpbnRlcnNlY3QsIGJlY2F1c2UgdGhlIGVuZCBpcyBhbHJlYWR5IHNlbGVjdGVkXG4gICAgICAgIHJldHVyblxuICAgICAgIyBmaW5kIGZpcnN0IHNlbGVjdGlvbiB0byB0aGUgbGVmdFxuICAgICAgbyA9IHRvXG4gICAgICB3aGlsZSAobm90IG8uc2VsZWN0aW9uPykgYW5kIChvIGlzbnQgZnJvbSlcbiAgICAgICAgbyA9IG8ucHJldl9jbFxuICAgICAgaWYgKG5vdCBvLnNlbGVjdGlvbj8pIG9yIG8uc2VsZWN0aW9uW1widG9cIl0gaXMgb1xuICAgICAgICAjIG5vIGludGVyc2VjdGlvblxuICAgICAgICByZXR1cm5cbiAgICAgICMgV2UgZm91bmQgYSBzZWxlY3Rpb24gdGhhdCBpbnRlcnNlY3RzIHdpdGggJHRvLlxuICAgICAgIyBOb3cgd2UgaGF2ZSB0byBjdXQgaXQgaW4gc3VjaCBhIHdheSxcbiAgICAgICMgdGhhdCB0aGUgc2VsZWN0aW9uIGRvZXMgbm90IGludGVyc2VjdCB3aXRoICR0byBhbnltb3JlLlxuXG4gICAgICAjIHRoaXMgaXMgYSByZWZlcmVuY2UgZm9yIHRoZSBzZWxlY3Rpb25zIHRoYXQgYXJlIGNyZWF0ZWQvbW9kaWZpZWQ6XG4gICAgICAjIGl0IGlzIHNpbWlsYXIgdG8gdGhlIG9uZSBhYm92ZSwgZXhjZXB0IHRoYXQgd2UgZG8gbm90IG5lZWQgb3B0X3NlbGVjdGlvbiBhbnltb3JlIVxuICAgICAgIyBvbGRfc2VsZWN0aW9uIGlzIGlubmVyIChiZXR3ZWVuICRmcm9tIGFuZCAkdG8pXG4gICAgICAjICAgLSB3aWxsIGJlIGNoYW5nZWQgaW4gc3VjaCBhIHdheSB0aGF0IGl0IGlzIHRvIHRoZSBsZWZ0IG9mICR0b1xuICAgICAgIyBuZXdfc2VsZWN0aW9uIGlzIG91dGVyICggb3V0ZXIgJGZyb20gYW5kICR0bylcbiAgICAgICMgICAtIGNyZWF0ZWQsIHJpZ2h0IGFmdGVyICR0b1xuXG4gICAgICBvbGRfc2VsZWN0aW9uID0gby5zZWxlY3Rpb25cblxuICAgICAgIyBjcmVhdGUgJG5ld19zZWxlY3Rpb25cbiAgICAgIG5ld19zZWxlY3Rpb24gPSBjcmVhdGVTZWxlY3Rpb24gdG8ubmV4dF9jbCwgb2xkX3NlbGVjdGlvbi50bywgb2xkX3NlbGVjdGlvbi5hdHRyc1xuXG4gICAgICAjIHVwZGF0ZSByZWZlcmVuY2VzXG4gICAgICBvbGRfc2VsZWN0aW9uLnRvID0gdG9cbiAgICAgICMgdXBkYXRlIHJlZmVyZW5jZXMgKHBvaW50ZXJzIHRvIHJlc3BlY3RpdmUgc2VsZWN0aW9ucylcbiAgICAgIG9sZF9zZWxlY3Rpb24udG8uc2VsZWN0aW9uID0gb2xkX3NlbGVjdGlvblxuXG4gICAgICBuZXdfc2VsZWN0aW9uLmZyb20uc2VsZWN0aW9uID0gbmV3X3NlbGVjdGlvblxuICAgICAgbmV3X3NlbGVjdGlvbi50by5zZWxlY3Rpb24gPSBuZXdfc2VsZWN0aW9uXG5cbiAgICBjdXRfb2ZmX3RvKClcblxuICAgICMgMy4gZXh0ZW5kIC8gYWRkIHNlbGVjdGlvbnMgaW4gYmV0d2VlblxuICAgIG8gPSBmcm9tXG4gICAgd2hpbGUgKG8gaXNudCB0by5uZXh0X2NsKVxuICAgICAgaWYgby5zZWxlY3Rpb24/XG4gICAgICAgIGNvbnNvbGUubG9nIFwiMVwiXG4gICAgICAgICMganVzdCBleHRlbmQgdGhlIGV4aXN0aW5nIHNlbGVjdGlvblxuICAgICAgICBleHRlbmRTZWxlY3Rpb24gby5zZWxlY3Rpb24sIGRlbHRhICMgd2lsbCBwdXNoIHVuZG8tZGVsdGFzIHRvICR1bmRvc1xuICAgICAgICBvID0gby5zZWxlY3Rpb24udG8ubmV4dF9jbFxuICAgICAgZWxzZVxuICAgICAgICAjIGNyZWF0ZSBhIG5ldyBzZWxlY3Rpb24gKHVudGlsIHlvdSBmaW5kIHRoZSBuZXh0IG9uZSlcbiAgICAgICAgY29uc29sZS5sb2cgXCIyXCJcbiAgICAgICAgc3RhcnQgPSBvXG4gICAgICAgIHdoaWxlIChub3Qgby5uZXh0X2NsLnNlbGVjdGlvbj8pIGFuZCAobyBpc250IHRvKVxuICAgICAgICAgIG8gPSBvLm5leHRfY2xcbiAgICAgICAgZW5kID0gb1xuICAgICAgICBpZiBkZWx0YS50eXBlIGlzbnQgXCJ1bnNlbGVjdFwiXG4gICAgICAgICAgYXR0cl9saXN0ID0gW11cbiAgICAgICAgICBmb3Igbix2IG9mIGRlbHRhLmF0dHJzXG4gICAgICAgICAgICBhdHRyX2xpc3QucHVzaCBuXG4gICAgICAgICAgdW5kb3MucHVzaFxuICAgICAgICAgICAgZnJvbTogc3RhcnQuZ2V0VWlkKClcbiAgICAgICAgICAgIHRvOiBlbmQuZ2V0VWlkKClcbiAgICAgICAgICAgIGF0dHJzOiBhdHRyX2xpc3RcbiAgICAgICAgICAgIHR5cGU6IFwidW5zZWxlY3RcIlxuICAgICAgICAgIHNlbGVjdGlvbiA9IGNyZWF0ZVNlbGVjdGlvbiBzdGFydCwgZW5kLCBkZWx0YS5hdHRyc1xuICAgICAgICAgIHN0YXJ0LnNlbGVjdGlvbiA9IHNlbGVjdGlvblxuICAgICAgICAgIGVuZC5zZWxlY3Rpb24gPSBzZWxlY3Rpb25cbiAgICAgICAgbyA9IG8ubmV4dF9jbFxuXG4gICAgcmV0dXJuIGRlbHRhICMgaXQgaXMgbmVjZXNzYXJ5IHRoYXQgZGVsdGEgaXMgcmV0dXJuZWQgaW4gdGhlIHdheSBpdCB3YXMgYXBwbGllZCBvbiB0aGUgZ2xvYmFsIGRlbHRhLlxuICAgICMgc28gdGhhdCB5anMgY2FuIGtub3cgZXhhY3RseSB3aGF0IHdhcyBhcHBsaWVkLlxuXG4gICMgXCJ1bmRvXCIgYSBkZWx0YSBmcm9tIHRoZSBjb21wb3NpdGlvbl92YWx1ZVxuICBfdW5hcHBseTogKGRlbHRhcyktPlxuICAgICMgX2FwcGx5IHJldHVybnMgYSBfbGlzdF8gb2YgZGVsdGFzLCB0aGF0IGFyZSBuZWNjZXNzYXJ5IHRvIHVuZG8gdGhlIGNoYW5nZS4gTm93IHdlIF9hcHBseSBldmVyeSBkZWx0YSBpbiB0aGUgbGlzdCAoYW5kIGRpc2NhcmQgdGhlIHJlc3VsdHMpXG4gICAgZm9yIGRlbHRhIGluIGRlbHRhc1xuICAgICAgQF9hcHBseSBkZWx0YVxuICAgIHJldHVyblxuXG4gICMgdXBkYXRlIHRoZSBnbG9iYWxEZWx0YSB3aXRoIGRlbHRhXG5cblxuICAjIHNlbGVjdCBfZnJvbV8sIF90b18gd2l0aCBhbiBfYXR0cmlidXRlX1xuICBzZWxlY3Q6IChmcm9tLCB0bywgYXR0cnMpLT5cbiAgICBkZWx0YSA9ICMgcHJvYmFibHkgbm90IGFzIGVhc3kgYXMgdGhpc1xuICAgICAgZnJvbTogZnJvbS5nZXRVaWQoKVxuICAgICAgdG86IHRvLmdldFVpZCgpXG4gICAgICBhdHRyczogYXR0cnNcbiAgICAgIHR5cGU6IFwic2VsZWN0XCJcblxuICAgIEBfbW9kZWwuYXBwbHlEZWx0YShkZWx0YSlcblxuICAjIHVuc2VsZWN0IF9mcm9tXywgX3RvXyB3aXRoIGFuIF9hdHRyaWJ1dGVfXG4gIHVuc2VsZWN0OiAoZnJvbSwgdG8sIGF0dHJzKS0+XG4gICAgaWYgdHlwZW9mIGF0dHJzIGlzIFwic3RyaW5nXCJcbiAgICAgIGF0dHJzID0gW2F0dHJzXVxuICAgIGlmIGF0dHJzLmNvbnN0cnVjdG9yIGlzbnQgQXJyYXlcbiAgICAgIHRocm93IG5ldyBFcnJvciBcIlkuU2VsZWN0aW9ucy5wcm90b3R5cGUudW5zZWxlY3QgZXhwZWN0cyBhbiBBcnJheSBvciBTdHJpbmcgYXMgdGhlIHRoaXJkIHBhcmFtZXRlciAoYXR0cmlidXRlcykhXCJcbiAgICBkZWx0YSA9ICMgcHJvYmFibHkgbm90IGFzIGVhc3kgYXMgdGhpc1xuICAgICAgZnJvbTogZnJvbS5nZXRVaWQoKVxuICAgICAgdG86IHRvLmdldFVpZCgpXG4gICAgICBhdHRyczogYXR0cnNcbiAgICAgIHR5cGU6IFwidW5zZWxlY3RcIlxuXG4gICAgQF9tb2RlbC5hcHBseURlbHRhKGRlbHRhKVxuXG4gICMgKiBnZXQgYWxsIHRoZSBzZWxlY3Rpb25zIG9mIGEgeS1saXN0XG4gICMgKiB0aGlzIHdpbGwgYWxzbyB0ZXN0IGlmIHRoZSBzZWxlY3Rpb25zIGFyZSB3ZWxsIGZvcm1lZCAoYWZ0ZXIgJGZyb20gZm9sbG93cyAkdG8gZm9sbG93cyAkZnJvbSAuLilcbiAgZ2V0U2VsZWN0aW9uczogKGxpc3QpLT5cbiAgICBvID0gbGlzdC5yZWYoMClcbiAgICBzZWxfc3RhcnQgPSBudWxsXG4gICAgcG9zID0gMFxuICAgIHJlc3VsdCA9IFtdXG5cbiAgICB3aGlsZSBvLm5leHRfY2w/XG4gICAgICBpZiBvLnNlbGVjdGlvbj9cbiAgICAgICAgaWYgby5zZWxlY3Rpb24uZnJvbSBpcyBvXG4gICAgICAgICAgaWYgc2VsX3N0YXJ0P1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yIFwiRm91bmQgdHdvIGNvbnNlY3V0aXZlIGZyb20gZWxlbWVudHMuIFRoZSBzZWxlY3Rpb25zIGFyZSBubyBsb25nZXIgc2FmZSB0byB1c2UhIChjb250YWN0IHRoZSBvd25lciBvZiB0aGUgcmVwb3NpdG9yeSlcIlxuICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHNlbF9zdGFydCA9IHBvc1xuICAgICAgICBpZiBvLnNlbGVjdGlvbi50byBpcyBvXG4gICAgICAgICAgaWYgc2VsX3N0YXJ0P1xuICAgICAgICAgICAgbnVtYmVyX29mX2F0dHJzID0gMFxuICAgICAgICAgICAgYXR0cnMgPSB7fVxuICAgICAgICAgICAgZm9yIG4sdiBvZiBvLnNlbGVjdGlvbi5hdHRyc1xuICAgICAgICAgICAgICBhdHRyc1tuXSA9IHZcbiAgICAgICAgICAgICAgbnVtYmVyX29mX2F0dHJzKytcbiAgICAgICAgICAgIGlmIG51bWJlcl9vZl9hdHRycyA+IDBcbiAgICAgICAgICAgICAgcmVzdWx0LnB1c2hcbiAgICAgICAgICAgICAgICBmcm9tOiBzZWxfc3RhcnRcbiAgICAgICAgICAgICAgICB0bzogcG9zXG4gICAgICAgICAgICAgICAgYXR0cnM6IGF0dHJzXG4gICAgICAgICAgICBzZWxfc3RhcnQgPSBudWxsXG4gICAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yIFwiRm91bmQgdHdvIGNvbnNlY3V0aXZlIHRvIGVsZW1lbnRzLiBUaGUgc2VsZWN0aW9ucyBhcmUgbm8gbG9uZ2VyIHNhZmUgdG8gdXNlISAoY29udGFjdCB0aGUgb3duZXIgb2YgdGhlIHJlcG9zaXRvcnkpXCJcbiAgICAgICAgZWxzZSBpZiBvLnNlbGVjdGlvbi5mcm9tIGlzbnQgb1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvciBcIlRoaXMgcmVmZXJlbmNlIHNob3VsZCBub3QgcG9pbnQgdG8gdGhpcyBzZWxlY3Rpb24sIGJlY2F1c2UgdGhlIHNlbGVjdGlvbiBkb2VzIG5vdCBwb2ludCB0byB0aGUgcmVmZXJlbmNlLiBUaGUgc2VsZWN0aW9ucyBhcmUgbm8gbG9uZ2VyIHNhZmUgdG8gdXNlISAoY29udGFjdCB0aGUgb3duZXIgb2YgdGhlIHJlcG9zaXRvcnkpXCJcbiAgICAgIHBvcysrXG4gICAgICBvID0gby5uZXh0X2NsXG4gICAgcmV0dXJuIHJlc3VsdFxuXG4gIG9ic2VydmU6IChmKS0+XG4gICAgQF9saXN0ZW5lcnMucHVzaCBmXG5cbiAgdW5vYnNlcnZlOiAoZiktPlxuICAgIEBfbGlzdGVuZXJzID0gQF9saXN0ZW5lcnMuZmlsdGVyIChnKS0+XG4gICAgICBmICE9IGdcblxuXG5pZiB3aW5kb3c/XG4gIGlmIHdpbmRvdy5ZP1xuICAgIHdpbmRvdy5ZLlNlbGVjdGlvbnMgPSBZU2VsZWN0aW9uc1xuICBlbHNlXG4gICAgdGhyb3cgbmV3IEVycm9yIFwiWW91IG11c3QgZmlyc3QgaW1wb3J0IFkhXCJcblxuaWYgbW9kdWxlP1xuICBtb2R1bGUuZXhwb3J0cyA9IFlTZWxlY3Rpb25zXG5cblxuXG4iXX0=
